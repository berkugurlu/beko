<!DOCTYPE html>
<html lang="tr" data-theme="light"> <!-- Varsayılan tema -->
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vuelina | Akıllı Seyahat Rehberi</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@700&display=swap" rel="stylesheet">
    <link rel="icon" type="image/svg+xml" href="/favicon.svg">
    <!-- Google AdSense Kodu -->
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9708298035800838"
     crossorigin="anonymous"></script>

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-E483B9402G"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-E483B9402G');
    </script>

    <style>
        :root {
            --background: #F8F9FA;
            --card-bg: #FFFFFF;
            --text-primary: #18181B;
            --text-secondary: #71717A;
            --accent: #4F46E5;
            --accent-dark: #4338CA;
            --border-color: #E4E4E7;
            --shadow-color: rgba(0, 0, 0, 0.05);
        }

        html[data-theme='dark'] {
            --background: #121212;
            --card-bg: #1E1E1E;
            --text-primary: #FAFAFA;
            --text-secondary: #A1A1AA;
            --accent: #818CF8;
            --accent-dark: #6366F1;
            --border-color: #27272A;
            --shadow-color: rgba(0, 0, 0, 0.2);
        }

        /* YENİ: Sunset Teması */
        html[data-theme='sunset'] {
            --background: #1c192e;
            --card-bg: #2d2a45;
            --text-primary: #f5e8f1;
            --text-secondary: #b0a5c4;
            --accent: #ff8e6e;
            --accent-dark: #e67e62;
            --border-color: #4a466b;
            --shadow-color: rgba(0, 0, 0, 0.2);
        }
        
        /* YENİ: Forest Teması */
        html[data-theme='forest'] {
            --background: #f0f4f0;
            --card-bg: #ffffff;
            --text-primary: #1e3a24;
            --text-secondary: #5a6e60;
            --accent: #3a8a5b;
            --accent-dark: #2f6f4a;
            --border-color: #d8e0d8;
            --shadow-color: rgba(0, 0, 0, 0.05);
        }
        
        /* YENİ: Ocean Teması */
        html[data-theme='ocean'] {
            --background: #eef7ff;
            --card-bg: #ffffff;
            --text-primary: #0f3460;
            --text-secondary: #537895;
            --accent: #16c79a;
            --accent-dark: #12a27e;
            --border-color: #d1e3f3;
            --shadow-color: rgba(0, 0, 0, 0.05);
        }

        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--background);
            color: var(--text-primary);
            transition: background-color 0.3s ease, color 0.3s ease;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }
        
        .logo-font {
            font-family: 'Plus Jakarta Sans', sans-serif;
        }

        .content-card {
            background-color: var(--card-bg);
            border: 1px solid var(--border-color);
            box-shadow: 0 4px 12px var(--shadow-color);
            transition: all 0.3s ease;
            border-radius: 20px;
        }
        
        header { 
            position: sticky; top: 0; z-index: 50; 
            background-color: rgba(248, 249, 250, 0.8);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border-bottom: 1px solid var(--border-color);
        }

        html[data-theme='dark'] header { background-color: rgba(18, 18, 18, 0.8); }
        html[data-theme='sunset'] header { background-color: rgba(28, 25, 46, 0.8); }
        html[data-theme='forest'] header { background-color: rgba(240, 244, 240, 0.8); }
        html[data-theme='ocean'] header { background-color: rgba(238, 247, 255, 0.8); }
        
        .country-card { 
            transition: transform 0.3s ease, box-shadow 0.3s ease; 
        }
        .country-card:hover { 
            transform: translateY(-8px); 
            box-shadow: 0 10px 25px var(--shadow-color);
        }

        .tab-button { 
            transition: all 0.2s ease; 
            border-bottom: 2px solid transparent;
            padding: 1rem 0.25rem;
        }
        .tab-button.active { color: var(--accent); border-bottom-color: var(--accent); }
        .tab-content { display: none; }
        .tab-content.active { display: block; animation: fadeInAnimation 0.4s ease forwards; }
        
        .modal-overlay { 
            position: fixed; top: 0; left: 0; right: 0; bottom: 0; 
            background-color: rgba(0, 0, 0, 0.4); 
            backdrop-filter: blur(4px); 
            z-index: 100; display: flex; align-items: center; justify-content: center; 
            opacity: 0; transition: opacity 0.3s ease; pointer-events: none; 
        }
        .modal-overlay.visible { opacity: 1; pointer-events: auto; }
        .modal-content { transform: scale(0.95) translateY(10px); transition: transform 0.3s cubic-bezier(0.2, 0.8, 0.2, 1); }
        .modal-overlay.visible .modal-content { transform: scale(1) translateY(0); }
        
        #preloader { 
            position: fixed; top: 0; left: 0; right: 0; bottom: 0; 
            background-color: var(--background); 
            z-index: 9999; display: flex; align-items: center; justify-content: center; 
            transition: opacity 0.5s ease; 
        }
        
        @keyframes fadeInAnimation { from { opacity: 0; } to { opacity: 1; } }
        
        .btn { 
            transition: all 0.2s ease; 
            border-radius: 12px;
            font-weight: 600;
        }
        .btn:disabled { opacity: 0.5; cursor: not-allowed; transform: none; box-shadow: none;}
        .btn-primary { 
            background-color: var(--accent); 
            color: white; 
        }
        .btn-primary:hover:not(:disabled) { 
            background-color: var(--accent-dark); 
            transform: translateY(-2px); 
            box-shadow: 0 6px 15px rgba(79, 70, 229, 0.2);
        }
        .btn-secondary { 
            background-color: var(--card-bg); 
            border: 1px solid var(--border-color); 
            color: var(--text-primary);
        }
        .btn-secondary:hover { 
            border-color: var(--accent);
            color: var(--accent);
        }

        html.dark input,
        html.dark textarea,
        html.dark select {
            color: var(--text-primary);
            background-color: var(--background);
            border-color: var(--border-color);
        }
        html.dark input::placeholder,
        html.dark textarea::placeholder {
            color: var(--text-secondary);
        }

        /* Tema Değişikliği */
        input, textarea, select {
            background-color: var(--background);
            border-color: var(--border-color);
            color: var(--text-primary);
        }
        input::placeholder, textarea::placeholder {
            color: var(--text-secondary);
        }

        #search-input:focus {
            background-color: var(--card-bg);
            box-shadow: 0 0 0 3px color-mix(in srgb, var(--accent) 30%, transparent);
            border-color: var(--accent);
        }
        .checklist-item { transition: all 0.2s ease; }
        .checklist-item.completed { opacity: 0.5; }
        .checklist-item.completed label { text-decoration: line-through; }
        
        /* Geliştirilmiş Reklam Alanı */
        .ad-placeholder {
            background-color: var(--background);
            border: 1px dashed var(--border-color);
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            color: var(--text-secondary);
            font-size: 0.8rem;
            min-height: 100px;
            border-radius: 16px;
        }
    </style>
</head>
<body class="min-h-screen flex flex-col">
    
    <div id="preloader" class="fade-in">
         <svg class="h-12 w-12" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
             <defs>
                 <linearGradient id="logo-gradient-preloader" gradientTransform="rotate(45)">
                     <stop offset="0%" stop-color="var(--accent)"/>
                     <stop offset="100%" stop-color="var(--accent-dark)"/>
                 </linearGradient>
             </defs>
             <path d="M12 2L3 22L12 17L21 22L12 2Z" fill="url(#logo-gradient-preloader)"/>
         </svg>
    </div>
    
    <header>
        <div class="container mx-auto px-4 py-4 flex justify-between items-center">
            <a href="#" id="home-link" class="flex items-center gap-3">
                <svg class="h-8 w-8" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <defs>
                        <linearGradient id="logo-gradient-header" gradientTransform="rotate(45)">
                            <stop offset="0%" stop-color="var(--accent)"/>
                            <stop offset="100%" stop-color="var(--accent-dark)"/>
                        </linearGradient>
                    </defs>
                    <path d="M12 2L3 22L12 17L21 22L12 2Z" fill="url(#logo-gradient-header)"/>
                </svg>
                <h1 class="text-2xl font-bold tracking-tighter logo-font">vuelina</h1>
            </a>
            <!-- YENİ: Navigasyon Menüsü -->
            <nav class="hidden md:flex items-center gap-6 text-sm font-semibold">
                <a href="#" class="text-secondary hover:text-primary transition-colors">Ana Sayfa</a>
                <a href="#" class="text-secondary hover:text-primary transition-colors">Blog</a>
                <a href="#" class="text-secondary hover:text-primary transition-colors">Hakkımızda</a>
                <a href="#" class="text-secondary hover:text-primary transition-colors">İletişim</a>
            </nav>
            <div class="flex items-center gap-2">
                <button id="checklist-btn" class="p-2 rounded-full focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-accent btn-secondary" title="Seyahat Listem">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline><line x1="16" y1="13" x2="8" y2="13"></line><line x1="16" y1="17" x2="8" y2="17"></line><polyline points="10 9 9 9 8 9"></polyline></svg>
                </button>
                <!-- YENİ: Tema Değiştirici Butonu -->
                <button id="theme-switcher-btn" class="p-2 rounded-full focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-accent btn-secondary" title="Temayı Değiştir">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 2.69l5.66 5.66a8 8 0 1 1-11.31 0z"></path></svg>
                </button>
            </div>
        </div>
    </header>

    <main class="container mx-auto px-4 py-10 sm:py-12 flex-grow">
        <div id="country-list-view">
            <div class="text-center mb-16">
                <h2 class="text-5xl md:text-6xl font-extrabold tracking-tight">Hayalindeki Macerayı Bul</h2>
                <p class="text-lg md:text-xl text-secondary mt-4 max-w-2xl mx-auto">Dünyanın en popüler destinasyonlarını keşfet veya yapay zekanın sana özel bir rota çizmesine izin ver.</p>
                <button id="suggest-place-btn" class="btn btn-primary mt-8 py-3 px-8 text-lg">
                    ✨ Bana Bir Yer Öner
                </button>
            </div>
            
            <!-- YENİ: Blog Bölümü (AdSense için içerik zenginleştirme) -->
            <section class="mb-16">
                <h3 class="text-3xl font-bold mb-6 text-center">İlham Veren Yazılar</h3>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                    <!-- Örnek Blog Kartı 1 -->
                    <div class="content-card overflow-hidden group">
                        <img src="https://placehold.co/600x400/818CF8/ffffff?text=Keşfet" alt="Blog Image" class="w-full h-48 object-cover group-hover:scale-105 transition-transform duration-300">
                        <div class="p-6">
                            <p class="text-sm text-secondary mb-1">SEYAHAT İPUÇLARI</p>
                            <h4 class="text-xl font-bold mb-2">Tek Başına Seyahat Etmenin Altın Kuralları</h4>
                            <a href="#" class="font-semibold text-accent hover:text-accent-dark">Devamını Oku →</a>
                        </div>
                    </div>
                    <!-- Örnek Blog Kartı 2 -->
                    <div class="content-card overflow-hidden group">
                        <img src="https://placehold.co/600x400/4F46E5/ffffff?text=Vuelina" alt="Blog Image" class="w-full h-48 object-cover group-hover:scale-105 transition-transform duration-300">
                        <div class="p-6">
                            <p class="text-sm text-secondary mb-1">GASTRONOMİ</p>
                            <h4 class="text-xl font-bold mb-2">İtalya'da Mutlaka Tatmanız Gereken 5 Lezzet</h4>
                            <a href="#" class="font-semibold text-accent hover:text-accent-dark">Devamını Oku →</a>
                        </div>
                    </div>
                     <!-- Örnek Blog Kartı 3 -->
                    <div class="content-card overflow-hidden group">
                        <img src="https://placehold.co/600x400/ff8e6e/ffffff?text=Rota" alt="Blog Image" class="w-full h-48 object-cover group-hover:scale-105 transition-transform duration-300">
                        <div class="p-6">
                            <p class="text-sm text-secondary mb-1">ROTA ÖNERİSİ</p>
                            <h4 class="text-xl font-bold mb-2">Vizesiz Gidebileceğiniz 10 Harika Balkan Ülkesi</h4>
                            <a href="#" class="font-semibold text-accent hover:text-accent-dark">Devamını Oku →</a>
                        </div>
                    </div>
                </div>
            </section>


            <div class="sticky top-[73px] z-40 mb-10 py-2" style="background: linear-gradient(to bottom, var(--background) 80%, transparent 100%);">
                 <div class="max-w-2xl mx-auto">
                     <h3 class="text-3xl font-bold mb-4 text-center">Tüm Ülkeleri Keşfet</h3>
                     <input type="text" id="search-input" class="w-full p-4 rounded-xl border border-border-color focus:outline-none" placeholder="Bir ülke ara (örn: Japonya)...">
                 </div>
            </div>

            <div id="country-list-container" class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6">
            </div>
            <div id="no-results" class="hidden text-center py-16 content-card">
                <p class="text-5xl mb-4">🗺️</p>
                <h3 class="text-2xl font-bold">Sonuç Bulunamadı</h3>
                <p class="text-secondary">Farklı bir anahtar kelimeyle tekrar dene.</p>
            </div>
        </div>

        <div id="country-detail-view" class="hidden">
        </div>
    </main>
    
    <!-- Geliştirilmiş Footer (AdSense için önemli) -->
    <footer class="text-center py-8 border-t border-border-color mt-12 bg-card-bg">
        <div class="container mx-auto px-4">
            <div class="ad-placeholder p-4 max-w-3xl mx-auto mb-8">
                 <!-- Reklam Alanı -->
                <ins class="adsbygoogle"
                     style="display:block"
                     data-ad-client="ca-pub-9708298035800838"
                     data-ad-slot="YOUR_AD_SLOT_ID"
                     data-ad-format="auto"
                     data-full-width-responsive="true"></ins>
            </div>
            <div class="flex justify-center gap-6 mb-6">
                <a href="#" class="text-sm text-secondary hover:text-primary">Hakkımızda</a>
                <a href="#" class="text-sm text-secondary hover:text-primary">İletişim</a>
                <a href="#" class="text-sm text-secondary hover:text-primary">Gizlilik Politikası</a>
                <a href="#" class="text-sm text-secondary hover:text-primary">Kullanım Şartları</a>
            </div>
            <p class="text-sm text-secondary">&copy; 2025 Vuelina </p>
        </div>
    </footer>

    <!-- Modallar -->
    <div id="info-modal" class="modal-overlay" aria-modal="true" role="dialog">
      <div class="modal-content content-card w-full max-w-md p-8 text-center">
          <h3 id="modal-title" class="text-2xl font-bold mb-2">Başlık</h3>
          <p id="modal-text" class="text-secondary mb-6">Metin.</p>
          <button id="modal-close-btn" class="btn btn-primary w-full py-3">Anladım</button>
      </div>
    </div>
    
    <div id="ai-suggest-modal" class="modal-overlay" aria-modal="true" role="dialog">
        <div class="modal-content content-card w-full max-w-2xl p-8">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-2xl font-bold">✨ Yapay Zeka Seyahat Danışmanı</h3>
                <button id="ai-modal-close-btn" class="text-2xl text-gray-400 hover:text-gray-800 dark:hover:text-white">&times;</button>
            </div>
            <div id="ai-suggestion-form">
                <p class="text-secondary mb-4">Nasıl bir macera aradığını anlat, sana en uygun 3 yeri önereyim.</p>
                <textarea id="ai-prompt-input" rows="4" class="w-full p-3 mb-4 rounded-lg bg-background border border-border-color focus:outline-none focus:ring-2 focus:ring-accent" placeholder="Örnek: Aralık ayında, bir haftalığına, romantik ve tarihi bir gezi arıyorum. Çok pahalı olmasın."></textarea>
                <button id="get-ai-suggestion-btn" class="btn btn-primary w-full py-3 text-lg">Önerileri Getir</button>
            </div>
            <div id="ai-suggestion-result" class="mt-4 prose dark:prose-invert max-w-none"></div>
        </div>
    </div>

    <div id="checklist-modal" class="modal-overlay" aria-modal="true" role="dialog">
        <div class="modal-content content-card w-full max-w-2xl p-8">
            <div class="flex justify-between items-center mb-6">
                <h3 class="text-2xl font-bold">✈️ Seyahat Kontrol Listem</h3>
                <button id="checklist-modal-close-btn" class="text-2xl text-gray-400 hover:text-gray-800 dark:hover:text-white">&times;</button>
            </div>
            <div id="checklist-container" class="space-y-3 max-h-[50vh] overflow-y-auto pr-2"></div>
            <div class="flex gap-2 mt-4">
                <input type="text" id="new-checklist-item-input" class="w-full p-3 rounded-lg bg-background border border-border-color focus:outline-none focus:ring-2 focus:ring-accent" placeholder="Yeni görev ekle...">
                <button id="add-checklist-item-btn" class="btn btn-primary px-5 flex-shrink-0">Ekle</button>
            </div>
        </div>
    </div>

    <div id="itinerary-modal" class="modal-overlay" aria-modal="true" role="dialog">
        <div class="modal-content content-card w-full max-w-2xl p-8">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-2xl font-bold">🗺️ Seyahat Planı Oluştur</h3>
                <button id="itinerary-modal-close-btn" class="text-2xl text-gray-400 hover:text-gray-800 dark:hover:text-white">&times;</button>
            </div>
            <div id="itinerary-form">
                <p class="text-secondary mb-4" id="itinerary-modal-subtitle"></p>
                <div class="grid grid-cols-1 sm:grid-cols-2 gap-4 mb-4">
                    <input type="number" id="itinerary-duration" value="3" min="1" class="w-full p-3 rounded-lg bg-background border border-border-color" placeholder="Seyahat süresi (gün)">
                    <input type="text" id="itinerary-interests" class="w-full p-3 rounded-lg bg-background border border-border-color" placeholder="İlgi alanların (örn: tarih, yemek)">
                </div>
                <button id="get-itinerary-btn" class="btn btn-primary w-full py-3 text-lg">Planı Oluştur</button>
            </div>
        </div>
    </div>

    <!-- YENİ: Tema Seçim Modalı -->
    <div id="theme-modal" class="modal-overlay" aria-modal="true" role="dialog">
      <div class="modal-content content-card w-full max-w-sm p-6">
          <div class="flex justify-between items-center mb-4">
            <h3 class="text-xl font-bold">Tema Seç</h3>
            <button id="theme-modal-close-btn" class="text-2xl text-gray-400 hover:text-gray-800 dark:hover:text-white">&times;</button>
          </div>
          <div class="grid grid-cols-2 gap-4">
            <button class="theme-option-btn p-4 rounded-lg text-left" data-theme="light">
              <div class="w-full h-12 bg-[#F8F9FA] border border-[#E4E4E7] rounded-md mb-2"></div>
              Açık Tema
            </button>
            <button class="theme-option-btn p-4 rounded-lg text-left" data-theme="dark">
              <div class="w-full h-12 bg-[#121212] border border-[#27272A] rounded-md mb-2"></div>
              Koyu Tema
            </button>
            <button class="theme-option-btn p-4 rounded-lg text-left" data-theme='sunset'>
              <div class="w-full h-12 bg-[#1c192e] border border-[#4a466b] rounded-md mb-2"></div>
              Gün Batımı
            </button>
            <button class="theme-option-btn p-4 rounded-lg text-left" data-theme="forest">
              <div class="w-full h-12 bg-[#f0f4f0] border border-[#d8e0d8] rounded-md mb-2"></div>
              Orman
            </button>
             <button class="theme-option-btn p-4 rounded-lg text-left" data-theme="ocean">
              <div class="w-full h-12 bg-[#eef7ff] border border-[#d1e3f3] rounded-md mb-2"></div>
              Okyanus
            </button>
          </div>
      </div>
    </div>
    
    <script>
    // --- UYGULAMA BAŞLANGICI ---
    document.addEventListener('DOMContentLoaded', () => {
    
        // --- Sabitler ve DOM Elementleri ---
        const countryListView = document.getElementById('country-list-view');
        const countryDetailView = document.getElementById('country-detail-view');
        const countryListContainer = document.getElementById('country-list-container');
        const searchInput = document.getElementById('search-input');
        const noResults = document.getElementById('no-results');
        const preloader = document.getElementById('preloader');
        const themeSwitcherBtn = document.getElementById('theme-switcher-btn');
        const themeModal = document.getElementById('theme-modal');
        const themeModalCloseBtn = document.getElementById('theme-modal-close-btn');
        const infoModal = document.getElementById('info-modal');
        const modalTitle = document.getElementById('modal-title');
        const modalText = document.getElementById('modal-text');
        const modalCloseBtn = document.getElementById('modal-close-btn');
        const homeLink = document.getElementById('home-link');
        const suggestPlaceBtn = document.getElementById('suggest-place-btn');
        const aiSuggestModal = document.getElementById('ai-suggest-modal');
        const aiModalCloseBtn = document.getElementById('ai-modal-close-btn');
        const getAiSuggestionBtn = document.getElementById('get-ai-suggestion-btn');
        const aiPromptInput = document.getElementById('ai-prompt-input');
        const aiSuggestionResult = document.getElementById('ai-suggestion-result');
        const checklistBtn = document.getElementById('checklist-btn');
        const checklistModal = document.getElementById('checklist-modal');
        const checklistModalCloseBtn = document.getElementById('checklist-modal-close-btn');
        const checklistContainer = document.getElementById('checklist-container');
        const newChecklistItemInput = document.getElementById('new-checklist-item-input');
        const addChecklistItemBtn = document.getElementById('add-checklist-item-btn');
        const itineraryModal = document.getElementById('itinerary-modal');
        const itineraryModalCloseBtn = document.getElementById('itinerary-modal-close-btn');
        const getItineraryBtn = document.getElementById('get-itinerary-btn');
        
        let currencyRates = null;

        const icons = {
            sun: `<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"></circle><line x1="12" y1="1" x2="12" y2="3"></line><line x1="12" y1="21" x2="12" y2="23"></line><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line><line x1="1" y1="12" x2="3" y2="12"></line><line x1="21" y1="12" x2="23" y2="12"></line><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line></svg>`,
            moon: `<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path></svg>`,
            map: `<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"></path><circle cx="12" cy="10" r="3"></circle></svg>`,
            utensils: `<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M3 2v7c0 1.1.9 2 2 2h4a2 2 0 0 0 2-2V2"></path><path d="M7 2v20"></path><path d="M21 15V2v0a5 5 0 0 0-5 5v6c0 1.1.9 2 2 2h3z"></path></svg>`,
            bed: `<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M2 4v16h20V4Z"></path><path d="M2 10h20"></path><path d="M6 14v-4"></path></svg>`,
            info: `<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><line x1="12" y1="16" x2="12" y2="12"></line><line x1="12" y1="8" x2="12.01" y2="8"></line></svg>`,
            smartphone: `<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="5" y="2" width="14" height="20" rx="2" ry="2"></rect><line x1="12" y1="18" x2="12.01" y2="18"></line></svg>`,
            tools: `<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z"></path></svg>`,
            fastfood: `<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 11v1a3 3 0 0 0 3 3h10a3 3 0 0 0 3-3v-1"></path><path d="M17 11V7.1a2 2 0 0 0-2-2H9a2 2 0 0 0-2 2V11"></path><path d="M7 11v-2.5a1.5 1.5 0 1 1 3 0V11"></path><path d="M14 11v-2.5a1.5 1.5 0 1 1 3 0V11"></path></svg>`
        };
        
        const countriesData = {
            "Türkiye": { flag: "🇹🇷", description: "Tarihi ve doğal güzellikleriyle ünlü, Asya ve Avrupa kıtalarını birleştiren eşsiz bir ülke.", searchTerms: { flights: 'Turkiye', booking: 'Turkey' }, whatToDo: ["Ayasofya & Sultanahmet'i keşfet", "Kapadokya'da sıcak hava balonuyla uç", "Pamukkale travertenlerinde yürü", "Efes Antik Kenti'nin tarihini hisset"], whatToEat: ["Zengin Kebap çeşitleri", "Antep Baklavası", "Serpme Kahvaltı", "Meze kültürü ve Rakı"], whereToStay: ["İstanbul: Tarihi Yarımada veya Karaköy", "Kapadokya: Otantik mağara oteller", "Ege/Akdeniz: Butik oteller ve resortlar"], popularApps: [{name: "Getir", category: "Market & Yemek"}, {name: "BiTaksi", category: "Ulaşım"}, {name: "Yemeksepeti", category: "Yemek Siparişi"}, {name: "Google Maps", category: "Navigasyon"}], fastFoodChains: ["McDonald's", "Burger King", "Popeyes", "Usta Dönerci"], currency: "TRY", language: "Türkçe", emergencyNumber: "112", basicPhrases: [{tr:"Merhaba", local:"Merhaba"}, {tr:"Teşekkürler", local:"Teşekkürler"}], climate: "Genel olarak Akdeniz iklimi hakimdir; yazlar sıcak ve kurak, kışlar ılıman ve yağışlı geçer." },
            "İtalya": { flag: "🇮🇹", description: "Sanat, tarih, moda ve muhteşem yemekleriyle bilinen bir Akdeniz ülkesi.", searchTerms: { flights: 'Italya', booking: 'Italy' }, whatToDo: ["Roma'da Kolezyum ve Antik Forum'u gez", "Venedik kanallarında gondol turu yap", "Floransa'da Rönesans sanatını keşfet", "Amalfi Sahillerinin manzarasına doy"], whatToEat: ["Napoli'de odun ateşinde Pizza", "Taze ev yapımı Makarna (Pasta Fresca)", "Gerçek İtalyan Dondurması (Gelato)", "Espresso ve Tiramisu"], whereToStay: ["Roma: Tarihi merkez (Centro Storico)", "Toskana: Kırsal agriturismo çiftlik evleri", "Venedik: Kanallara bakan oteller"], popularApps: [{name: "Trenitalia", category: "Tren"}, {name: "TheFork", category: "Restoran Rezervasyon"}, {name: "FREE NOW", category: "Taksi"}, {name: "Booking.com", category: "Konaklama"}], fastFoodChains: ["McDonald's", "Burger King", "KFC", "Spizzico"], currency: "EUR", language: "İtalyanca", emergencyNumber: "112", basicPhrases: [{tr:"Merhaba", local:"Ciao"}, {tr:"Teşekkürler", local:"Grazie"}], climate: "Akdeniz iklimi. Kuzeyde kışlar daha soğuk ve kar yağışlı olabilir." },
            "Japonya": { flag: "🇯🇵", description: "Geleneksel kültürü ve fütüristik teknolojiyi bir arada sunan büyüleyici bir ada ülkesi.", searchTerms: { flights: 'Japonya', booking: 'Japan' }, whatToDo: ["Tokyo'da Shibuya Geçidi'nin kalabalığına karış", "Kyoto'nun bambu ormanlarında yürü", "Fuji Dağı'nın görkemini izle", "Osaka'da sokak lezzetlerini tat"], whatToEat: ["Usta elinden Suşi ve Sashimi", "Sıcak bir kase Ramen", "Hafif ve çıtır Tempura", "Japon yeşil çayı (Matcha)"], whereToStay: ["Tokyo: Shinjuku veya Shibuya bölgeleri", "Kyoto: Geleneksel Ryokan'lar", "Osaka: Namba'da modern oteller"], popularApps: [{name: "Jorudan", category: "Tren & Rota"}, {name: "Gurunavi", category: "Restoran Bulucu"}, {name: "Go", category: "Taksi"}, {name: "Google Translate", category: "Çeviri"}], fastFoodChains: ["McDonald's", "KFC", "Mos Burger", "Yoshinoya"], currency: "JPY", language: "Japonca", emergencyNumber: "110 (Polis), 119 (Ambulans/İtfaiye)", basicPhrases: [{tr:"Merhaba", local:"こんにちは (Konnichiwa)"}, {tr:"Teşekkürler", local:"ありがとう (Arigatou)"}], climate: "Dört mevsim belirgin yaşanır. Yazlar sıcak ve nemli, kışlar soğuk ve kar yağışlıdır." },
            "Fransa": { flag: "🇫🇷", description: "Moda, sanat, gastronomi ve romantizmin başkenti.", searchTerms: { flights: 'Fransa', booking: 'France' }, whatToDo: ["Eyfel Kulesi'nden Paris'i izle", "Louvre Müzesi'nde Mona Lisa'yı gör", "Mont Saint-Michel'in masalsı atmosferini yaşa", "Provence'da lavanta tarlalarını gez"], whatToEat: ["Fırından taze çıkmış Kruvasan", "Fransız peynirleri ve şarapları", "Renkli Makaronlar", "Soğan Çorbası"], whereToStay: ["Paris: Le Marais veya Saint-Germain", "Fransız Rivierası: Nice veya Cannes", "Provence: Şato oteller"], popularApps: [{name: "SNCF Connect", category: "Tren & Otobüs"}, {name: "TheFork", category: "Restoran Rezervasyon"}, {name: "Bonjour RATP", category: "Paris Ulaşım"}, {name: "Uber", category: "Ulaşım"}], fastFoodChains: ["McDonald's", "Burger King", "Quick", "KFC"], currency: "EUR", language: "Fransızca", emergencyNumber: "112", basicPhrases: [{tr:"Merhaba", local:"Bonjour"}, {tr:"Teşekkürler", local:"Merci"}], climate: "Ilıman iklim. Güneyde Akdeniz iklimi, Alpler'de dağ iklimi görülür." },
            "Birleşik Krallık": { flag: "🇬🇧", description: "Tarih, kraliyet gelenekleri, modern kültür ve yeşil kırsal alanların birleştiği bir ada ülkesi.", searchTerms: { flights: 'Birlesik-Krallik', booking: 'United-Kingdom' }, whatToDo: ["Londra'da Buckingham Sarayı ve Tower Bridge'i gör", "Edinburgh Kalesi'ni keşfet", "Stonehenge'in gizemini çöz", "İskoçya'nın Highlands bölgesinde doğa yürüyüşü yap"], whatToEat: ["Fish and Chips", "Sunday Roast (Pazar Yemeği)", "Full English Breakfast", "Afternoon Tea (Beş Çayı)"], whereToStay: ["Londra: Covent Garden veya South Kensington", "Edinburgh: Old Town'daki tarihi oteller", "Cotswolds: Geleneksel 'inn'ler"], popularApps: [{name: "Citymapper", category: "Ulaşım"}, {name: "Trainline", category: "Tren Bileti"}, {name: "Just Eat", category: "Yemek Siparişi"}, {name: "Uber", category: "Ulaşım"}], fastFoodChains: ["McDonald's", "KFC", "Burger King", "Greggs", "Subway"], currency: "GBP", language: "İngilizce", emergencyNumber: "999", basicPhrases: [{tr:"Merhaba", local:"Hello"}, {tr:"Teşekkürler", local:"Thank you / Cheers"}], climate: "Ilıman okyanus iklimi. Yıl boyunca yağışlı ve hava durumu değişkendir." },
            "ABD": { flag: "🇺🇸", description: "Çeşitli kültürleri ve coğrafi özellikleri barındıran devasa bir ülke.", searchTerms: { flights: 'Amerika-Birlesik-Devletleri', booking: 'United-States-of-America' }, whatToDo: ["New York'un gökdelenleri arasında kaybol", "Grand Canyon'un büyüklüğü karşısında şaşır", "Route 66'da araba yolculuğu yap", "Miami'nin Art Deco sahillerinde yürü"], whatToEat: ["New York usulü Pizza", "Texas usulü Barbekü (BBQ)", "California'dan taze Avokado Tost", "Pancakes ve akçaağaç şurubu"], whereToStay: ["New York: Manhattan'da merkezi bir otel", "California: Sahil kasabalarında butik oteller", "Ulusal Parklar: Kamping veya dağ evleri"], popularApps: [{name: "Uber / Lyft", category: "Ulaşım"}, {name: "Yelp", category: "Restoran & Yorum"}, {name: "DoorDash", category: "Yemek Siparişi"}, {name: "Airbnb", category: "Konaklama"}], fastFoodChains: ["McDonald's", "Burger King", "Wendy's", "Taco Bell", "Subway"], currency: "USD", language: "İngilizce", emergencyNumber: "911", basicPhrases: [{tr:"Merhaba", local:"Hello"}, {tr:"Teşekkürler", local:"Thank you"}], climate: "Çok çeşitli iklimler. Florida'da tropikal, Alaska'da kutup iklimi görülebilir." },
            "Brezilya": { flag: "🇧🇷", description: "Amazon ormanları, canlı kültürü ve futboluyla tanınan Güney Amerika ülkesi.", searchTerms: { flights: 'Brezilya', booking: 'Brazil' }, whatToDo: ["Kurtarıcı İsa Heykeli'nden Rio'yu seyret", "Amazon ormanlarında ekolojik tur yap", "Iguazu Şelaleleri'nin gücünü hisset", "Salvador'un renkli sokaklarında dans et"], whatToEat: ["Ulusal yemek Feijoada", "Churrasco barbekü ziyafeti", "Sokak lezzeti Pão de Queijo", "Enerji veren Açaí kaseleri"], whereToStay: ["Rio de Janeiro: Copacabana veya Ipanema", "Amazon: Sürdürülebilir orman locaları", "Salvador: Pelourinho'da tarihi konaklar"], popularApps: [{name: "99 / Uber", category: "Ulaşım"}, {name: "iFood", category: "Yemek Siparişi"}, {name: "Rappi", category: "Teslimat"}, {name: "WhatsApp", category: "İletişim"}], fastFoodChains: ["McDonald's", "Burger King", "Subway", "Bob's"], currency: "BRL", language: "Portekizce", emergencyNumber: "190 (Polis), 192 (Ambulans)", basicPhrases: [{tr:"Merhaba", local:"Olá"}, {tr:"Teşekkürler", local:"Obrigado/Obrigada"}], climate: "Büyük ölçüde tropikal. Güney bölgeler daha ılımandır." },
            "Mısır": { flag: "🇪🇬", description: "Antik medeniyetlere ev sahipliği yapmış, piramitleri ve Nil Nehri ile ünlü.", searchTerms: { flights: 'Misir', booking: 'Egypt' }, whatToDo: ["Gize Piramitleri ve Sfenks'in gizemini çöz", "Krallar Vadisi'ndeki firavun mezarlarını keşfet", "Nil Nehri'nde geleneksel Felucca ile yelken aç", "Dahab'da Kızıldeniz'in su altı dünyasını gör"], whatToEat: ["Sokak yemeği klasiği Koşari", "Ful Medames ile kahvaltı", "Mısır usulü Falafel (Ta'ameya)", "Geleneksel tatlı Umm Ali"], whereToStay: ["Kahire: Nil manzaralı modern oteller", "Luxor: Tarihe yakın butik oteller", "Kızıldeniz sahili: Dalış ve spa resortları"], popularApps: [{name: "Uber / Careem", category: "Ulaşım"}, {name: "Talabat", category: "Yemek Siparişi"}, {name: "Swvl", category: "Otobüs & Ulaşım"}, {name: "Google Maps", category: "Navigasyon"}], fastFoodChains: ["McDonald's", "KFC", "Hardee's", "Cook Door"], currency: "EGP", language: "Arapça", emergencyNumber: "122 (Polis), 123 (Ambulans)", basicPhrases: [{tr:"Merhaba", local:"مرحبا (Marhaban)"}, {tr:"Teşekkürler", local:"شكرا (Shukran)"}], climate: "Sıcak çöl iklimi. Kıyı şeridi daha ılımandır." },
            "Avustralya": { flag: "🇦🇺", description: "Eşsiz vahşi yaşamı, mercan resifleri ve modern şehirleriyle bilinen bir kıta ülke.", searchTerms: { flights: 'Avustralya', booking: 'Australia' }, whatToDo: ["Sydney Opera Binası önünde fotoğraf çek", "Büyük Set Resifi'nde şnorkelle dal", "Melbourne'ün sanat dolu sokaklarında kaybol", "Uluru'da gün batımını ve doğuşunu izle"], whatToEat: ["Sahilde Fish and Chips keyfi", "Avustralyalıların favorisi Vegemite on toast", "Lamington keki", "Taze deniz ürünleri barbeküsü"], whereToStay: ["Sydney: Circular Quay veya The Rocks", "Melbourne: Merkezi İş Bölgesi (CBD)", "Queensland: Whitsundays adalarında resortlar"], popularApps: [{name: "Uber / DiDi", category: "Ulaşım"}, {name: "Menulog", category: "Yemek Siparişi"}, {name: "TripView", category: "Toplu Taşıma"}, {name: "Airbnb", category: "Konaklama"}], fastFoodChains: ["McDonald's (Macca's)", "Hungry Jack's (Burger King)", "KFC", "Domino's"], currency: "AUD", language: "İngilizce", emergencyNumber: "000", basicPhrases: [{tr:"Merhaba", local:"G'day"}, {tr:"Teşekkürler", local:"Cheers"}], climate: "Güneyde ılıman, kuzeyde tropikal, iç kesimlerde çöl iklimi." },
            "İspanya": { flag: "🇪🇸", description: "Flamenko, tapas ve güneşli sahilleriyle ünlü canlı bir Avrupa ülkesi.", searchTerms: { flights: 'Ispanya', booking: 'Spain' }, whatToDo: ["Barselona'da Gaudi'nin mimarisini takip et", "Endülüs'te Alhambra Sarayı'nı gez", "Madrid'de sanat müzelerini dolaş", "İbiza'da güneşin ve müziğin tadını çıkar"], whatToEat: ["Valensiya usulü Paella", "Çeşit çeşit Tapas", "Sıcak çikolatayla Churros", "Endülüs'ten soğuk Gazpacho çorbası"], whereToStay: ["Barselona: Gotik Mahalle veya Eixample", "Madrid: Gran Via çevresi", "Sevilla: Santa Cruz'un dar sokakları"], popularApps: [{name: "Cabify / FREE NOW", category: "Ulaşım"}, {name: "Glovo", category: "Teslimat & Yemek"}, {name: "Renfe", category: "Tren"}, {name: "ElTenedor", category: "Restoran Rezervasyon"}], fastFoodChains: ["McDonald's", "Burger King", "KFC", "Telepizza"], currency: "EUR", language: "İspanyolca", emergencyNumber: "112", basicPhrases: [{tr:"Merhaba", local:"Hola"}, {tr:"Teşekkürler", local:"Gracias"}], climate: "Akdeniz iklimi. İç kesimlerde karasal iklim etkileri görülür." },
            "Yunanistan": { flag: "🇬🇷", description: "Antik felsefenin doğduğu topraklar, binlerce ada ve masmavi deniz.", searchTerms: { flights: 'Yunanistan', booking: 'Greece' }, whatToDo: ["Atina'da Akropolis'in tepesine tırman", "Santorini'de Oia'nın meşhur gün batımını izle", "Meteora'nın gökyüzündeki manastırlarını ziyaret et", "Girit'in eşsiz plajlarını keşfet"], whatToEat: ["Fırında Musakka", "Tzatziki ile Souvlaki (Dürüm)", "Yunan Salatasında gerçek Feta peyniri", "Ballı ve cevizli Yunan Yoğurdu"], whereToStay: ["Santorini: Kaldera manzaralı oteller", "Atina: Plaka'nın tarihi atmosferi", "Mikonos: Şehir merkezinde butik oteller"], popularApps: [{name: "Beat / FREE NOW", category: "Taksi"}, {name: "Wolt", category: "Yemek Siparişi"}, {name: "Ferryhopper", category: "Feribot Biletleri"}, {name: "Booking.com", category: "Konaklama"}], fastFoodChains: ["McDonald's", "Goody's Burger House", "KFC", "Everest"], currency: "EUR", language: "Yunanca", emergencyNumber: "112", basicPhrases: [{tr:"Merhaba", local:"Γειά σου (Yia sou)"}, {tr:"Teşekkürler", local:"Ευχαριστώ (Efcharistó)"}], climate: "Akdeniz iklimi. Adalarda yazlar sıcak ve kuraktır." },
            "Tayland": { flag: "🇹🇭", description: "Egzotik tapınaklar, hareketli sokak pazarları ve tropik adalar diyarı.", searchTerms: { flights: 'Tayland', booking: 'Thailand' }, whatToDo: ["Bangkok'un yüzen pazarlarında alışveriş yap", "Chiang Mai'de bir fil sığınağını ziyaret et", "Phi Phi Adaları'nın turkuaz sularında yüz", "Ayutthaya'nın antik tapınaklarını gez"], whatToEat: ["Sokak tezgahlarından Pad Thai", "Acılı ve ekşili Tom Yum çorbası", "Tatlı ve yapışkan Mango Sticky Rice", "Yeşil Körili Tavuk (Green Curry)"], whereToStay: ["Bangkok: Sukhumvit veya Riverside", "Phuket: Lüks sahil resortları", "Chiang Mai: Eski şehir içindeki butik oteller"], popularApps: [{name: "Grab", category: "Ulaşım & Yemek"}, {name: "Agoda", category: "Konaklama"}, {name: "LINE", category: "İletişim"}, {name: "Klook", category: "Aktivite & Tur"}], fastFoodChains: ["McDonald's", "KFC", "Burger King", "Chester's"], currency: "THB", language: "Tayca", emergencyNumber: "1155 (Turist Polisi)", basicPhrases: [{tr:"Merhaba", local:"สวัสดี (Sawasdee)"}, {tr:"Teşekkürler", local:"ขอบคุณ (Khop khun)"}], climate: "Tropikal muson iklimi. Yıl boyunca sıcak ve nemlidir." },
            // ... diğer ülkeler ...
        };

        const showInfoModal = (title, text) => {
            modalTitle.textContent = title;
            modalText.textContent = text;
            infoModal.classList.add('visible');
        };
        
        const formatGeminiResponse = (text) => {
            let html = '';
            const lines = text.split('\n').filter(line => line.trim() !== '');
            let inList = false;

            lines.forEach(line => {
                line = line.trim().replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>').replace(/\*(.*?)\*/g, '<em>$1</em>');
                
                if (line.startsWith('###')) {
                    html += `</ul>${inList ? '</ul>' : ''}<h3 class="text-xl font-semibold mt-4 mb-2">${line.replace(/###\s*/, '')}</h3>`;
                    inList = false;
                } else if (line.startsWith('##')) {
                    html += `${inList ? '</ul>' : ''}<h2 class="text-2xl font-bold mt-5 mb-3">${line.replace(/##\s*/, '')}</h2>`;
                    inList = false;
                } else if (line.startsWith('-') || line.startsWith('*')) {
                    if (!inList) {
                        html += '<ul class="list-disc pl-5 space-y-2 mt-2">';
                        inList = true;
                    }
                    html += `<li class="text-secondary">${line.substring(1).trim()}</li>`;
                } else {
                    html += `${inList ? '</ul>' : ''}<p class="text-secondary mb-3">${line}</p>`;
                    inList = false;
                }
            });
            if (inList) html += '</ul>';
            return html;
        };

        const copyToClipboard = (text) => {
            const textArea = document.createElement("textarea");
            textArea.value = text;
            document.body.appendChild(textArea);
            textArea.select();
            try {
                document.execCommand('copy');
                showInfoModal('Başarılı!', 'Seyahat planı panoya kopyalandı.');
            } catch (err) {
                showInfoModal('Hata!', 'Otomatik kopyalama başarısız oldu.');
            }
            document.body.removeChild(textArea);
        };
        
        const displayCountries = (filter = '') => {
            countryListContainer.innerHTML = '';
            const normalizedFilter = filter.toLowerCase().trim();
            const countryNames = Object.keys(countriesData).sort((a,b) => a.localeCompare(b, 'tr'));
            let adInserted = false;

            countryNames.forEach((name, index) => {
                if (name.toLowerCase().includes(normalizedFilter)) {
                    const country = countriesData[name];
                    const card = document.createElement('div');
                    card.className = 'country-card content-card p-6 text-center cursor-pointer';
                    card.innerHTML = `
                        <p class="text-6xl mb-4">${country.flag}</p>
                        <h3 class="text-lg font-semibold mb-1">${name}</h3>
                        <p class="text-sm text-secondary">${country.description}</p>
                    `;
                    card.addEventListener('click', () => displayCountryDetail(name));
                    countryListContainer.appendChild(card);
                }

                if (index === 7 && !adInserted && !filter) {
                    const adCard = document.createElement('div');
                    adCard.className = 'ad-placeholder content-card p-6 text-center lg:col-span-2 md:col-span-1 sm:col-span-2 col-span-1';
                     adCard.innerHTML = `
                        <ins class="adsbygoogle"
                             style="display:block; width:100%;"
                             data-ad-client="ca-pub-9708298035800838"
                             data-ad-slot="YOUR_AD_SLOT_ID_2"
                             data-ad-format="auto"
                             data-full-width-responsive="true"></ins>
                    `;
                    countryListContainer.appendChild(adCard);
                    adInserted = true;
                }
            });

            const hasResults = countryListContainer.children.length > 0;
            noResults.classList.toggle('hidden', hasResults);
        };
        
        const displayCountryDetail = (countryName) => {
            const country = countriesData[countryName];
            const popularAppsHtml = country.popularApps.map(app => `
                <li class="flex items-center">
                    <span class="font-semibold text-primary mr-2">${app.name}</span>
                    <span class="text-sm text-secondary">- ${app.category}</span>
                </li>
            `).join('');
            const fastFoodHtml = country.fastFoodChains.map(chain => `<li class="text-secondary">${chain}</li>`).join('');
            const basicPhrasesHtml = country.basicPhrases.map(phrase => `
                <li class="flex justify-between items-center">
                    <span class="text-primary">${phrase.tr}</span>
                    <span class="text-secondary font-semibold">${phrase.local}</span>
                </li>
            `).join('');

            countryListView.classList.add('hidden');
            countryDetailView.innerHTML = `
                <div class="fade-in">
                    <button id="back-to-list" class="btn btn-secondary mb-8 py-2 px-4 rounded-lg flex items-center">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="mr-2"><line x1="19" y1="12" x2="5" y2="12"></line><polyline points="12 19 5 12 12 5"></polyline></svg>
                        Geri Dön
                    </button>
                    <div class="content-card p-6 sm:p-10">
                        <div class="flex flex-col md:flex-row items-center text-center md:text-left mb-6">
                            <p class="text-8xl md:mr-8 mb-4 md:mb-0">${country.flag}</p>
                            <div>
                                <h2 class="text-5xl font-extrabold tracking-tight mb-2">${countryName}</h2>
                                <p class="text-lg text-secondary">${country.description}</p>
                            </div>
                        </div>

                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-8">
                            <a href="https://www.skyscanner.com.tr/ucak-biletleri-kalkis/tr/e/${country.searchTerms.flights}" target="_blank" class="btn btn-secondary flex items-center justify-center p-3">
                                ✈️ Uygun Uçuşları Ara
                            </a>
                            <a href="https://www.booking.com/searchresults.html?ss=${country.searchTerms.booking}" target="_blank" class="btn btn-secondary flex items-center justify-center p-3">
                                🏨 Otel ve Konaklama Bul
                            </a>
                        </div>

                        <div class="border-b border-border-color mb-6">
                            <nav class="flex space-x-2 sm:space-x-4 -mb-px overflow-x-auto" id="detail-tabs">
                                <button data-tab="todo" class="tab-button active font-medium text-base sm:text-lg flex items-center flex-shrink-0">${icons.map}<span class="ml-2">Yapılacaklar</span></button>
                                <button data-tab="toeat" class="tab-button font-medium text-base sm:text-lg flex items-center flex-shrink-0">${icons.utensils}<span class="ml-2">Lezzetler</span></button>
                                <button data-tab="tostay" class="tab-button font-medium text-base sm:text-lg flex items-center flex-shrink-0">${icons.bed}<span class="ml-2">Konaklama</span></button>
                                <button data-tab="fastfood" class="tab-button font-medium text-base sm:text-lg flex items-center flex-shrink-0">${icons.fastfood}<span class="ml-2">Fast Food</span></button>
                                <button data-tab="tools" class="tab-button font-medium text-base sm:text-lg flex items-center flex-shrink-0">${icons.tools}<span class="ml-2">Araçlar</span></button>
                            </nav>
                        </div>
                        
                        <div id="tab-content-container" class="text-secondary">
                            <div id="tab-todo" class="tab-content active">
                                <ul class="list-disc pl-5 space-y-2">${country.whatToDo.map(i => `<li>${i}</li>`).join('')}</ul>
                                <a href="https://www.getyourguide.com/${country.searchTerms.booking}" target="_blank" class="text-accent font-semibold inline-block mt-4">Bu bölgedeki turları ve aktiviteleri keşfet →</a>
                            </div>
                            <div id="tab-toeat" class="tab-content"><ul class="list-disc pl-5 space-y-2">${country.whatToEat.map(i => `<li>${i}</li>`).join('')}</ul></div>
                            <div id="tab-tostay" class="tab-content"><ul class="list-disc pl-5 space-y-2">${country.whereToStay.map(i => `<li>${i}</li>`).join('')}</ul></div>
                            <div id="tab-fastfood" class="tab-content"><ul class="list-disc pl-5 space-y-2">${fastFoodHtml}</ul></div>
                            <div id="tab-tools" class="tab-content space-y-8">
                                <div>
                                    <h4 class="font-bold text-lg mb-3 text-primary flex items-center">${icons.smartphone}<span class="ml-2">Popüler Uygulamalar</span></h4>
                                    <ul class="space-y-3">${popularAppsHtml}</ul>
                                </div>
                                <div id="currency-converter-container">
                                    <h4 class="font-bold text-lg mb-3 text-primary">Döviz Çevirici</h4>
                                    <div id="currency-converter-content">Yükleniyor...</div>
                                </div>
                                <div>
                                    <h4 class="font-bold text-lg mb-3 text-primary">İklim ve Hava Durumu</h4>
                                    <p>${country.climate}</p>
                                </div>
                                <div>
                                    <h4 class="font-bold text-lg mb-3 text-primary">Temel İfadeler</h4>
                                    <ul class="space-y-2">${basicPhrasesHtml}</ul>
                                </div>
                                 <div>
                                    <h4 class="font-bold text-lg mb-3 text-primary">Acil Durum Numarası</h4>
                                    <p class="text-2xl font-bold text-accent">${country.emergencyNumber}</p>
                                </div>
                            </div>
                        </div>

                        <div class="mt-12 pt-8 border-t border-border-color">
                             <h3 class="text-3xl font-bold text-center mb-6">✨ Yapay Zeka Asistanın</h3>
                             <div class="max-w-4xl mx-auto grid grid-cols-1 sm:grid-cols-3 gap-4">
                                 <div class="bg-background/50 p-6 rounded-2xl border border-border-color flex flex-col">
                                     <h4 class="font-bold text-lg mb-2">Seyahat Planı Oluştur</h4>
                                     <p class="text-sm text-secondary mb-3 flex-grow">Süre ve ilgi alanlarına göre kişisel rotanı oluştur.</p>
                                     <button id="open-itinerary-modal-btn" class="btn btn-primary w-full py-2 rounded-lg font-bold mt-auto">Planla!</button>
                                 </div>
                                 <div class="bg-background/50 p-6 rounded-2xl border border-border-color flex flex-col">
                                     <h4 class="font-bold text-lg mb-2">Kültürel İpuçları Al</h4>
                                     <p class="text-sm text-secondary mb-3 flex-grow">Yerel adetleri öğrenerek daha anlamlı bir gezi yap.</p>
                                      <button id="get-cultural-tips-btn" class="btn btn-primary w-full py-2 rounded-lg font-bold mt-auto">İpuçları Getir</button>
                                 </div>
                                 <div class="bg-background/50 p-6 rounded-2xl border border-border-color flex flex-col">
                                     <h4 class="font-bold text-lg mb-2">Bavul Hazırlama Asistanı</h4>
                                     <p class="text-sm text-secondary mb-3 flex-grow">Gideceğin yere ve mevsime göre bavulunu hazırla.</p>
                                      <button id="open-packing-list-btn" class="btn btn-primary w-full py-2 rounded-lg font-bold mt-auto">Bavul Hazırla</button>
                                 </div>
                             </div>
                             <div id="ai-results-container" class="mt-6 max-w-3xl mx-auto"></div>
                        </div>
                    </div>
                </div>`;
            countryDetailView.classList.remove('hidden');
            window.scrollTo({ top: 0, behavior: 'smooth' });
            
            initCurrencyConverter(country.currency);

            document.getElementById('back-to-list').addEventListener('click', () => {
                countryDetailView.classList.add('hidden');
                countryListView.classList.remove('hidden');
            });
            
            const tabs = document.getElementById('detail-tabs').querySelectorAll('button');
            tabs.forEach(tab => {
                tab.addEventListener('click', () => {
                    tabs.forEach(t => t.classList.remove('active'));
                    tab.classList.add('active');
                    document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
                    document.getElementById(`tab-${tab.dataset.tab}`).classList.add('active');
                });
            });

            document.getElementById('open-itinerary-modal-btn').addEventListener('click', () => {
                document.getElementById('itinerary-modal-subtitle').textContent = `${countryName} için plan oluştur.`;
                itineraryModal.classList.add('visible');
            });
            
            getItineraryBtn.onclick = () => { // Use onclick to easily re-assign it
                const duration = document.getElementById('itinerary-duration').value || "3";
                const interests = document.getElementById('itinerary-interests').value || "genel turistik yerler ve yerel lezzetler";
                generateItinerary(countryName, duration, interests);
                itineraryModal.classList.remove('visible');
            };

            document.getElementById('get-cultural-tips-btn').addEventListener('click', () => {
                getCulturalTips(countryName);
            });

            document.getElementById('open-packing-list-btn').addEventListener('click', () => {
                const duration = document.getElementById('itinerary-duration').value || "7";
                generatePackingList(countryName, duration, 'mevsimine uygun');
            });
        };

        const callGeminiAPI = async (prompt, buttonElement, resultContainer) => {
            const originalButtonText = buttonElement.innerHTML;
            buttonElement.disabled = true;
            const spinnerIcon = `<svg class="animate-spin -ml-1 mr-3 h-5 w-5" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg>`;
            buttonElement.innerHTML = `<span class="inline-flex items-center">${spinnerIcon} Oluşturuluyor...</span>`;
            resultContainer.innerHTML = `<div class="content-card p-6 rounded-2xl text-center text-secondary">Akıllı asistanımız senin için hazırlıyor...</div>`;

            try {
                const apiKey = ""; 
                const model = "gemini-2.5-flash-preview-09-2025";
                const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/${model}:generateContent?key=${apiKey}`;
                const payload = { contents: [{ parts: [{ text: prompt }] }] };

                const response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });

                if (!response.ok) {
                    const errorData = await response.json();
                    console.error("API Error Response:", errorData);
                    throw new Error(`API Hatası: ${response.status}. ${errorData.error?.message || 'Bilinmeyen bir hata oluştu.'}`);
                }
                const result = await response.json();
                if (result.candidates && result.candidates.length > 0 && result.candidates[0].content?.parts?.[0]?.text) {
                     return result.candidates[0].content.parts[0].text;
                } else {
                    console.error("Beklenmedik API yanıtı:", result);
                    if(result.candidates && result.candidates[0].finishReason === 'SAFETY') {
                        throw new Error("İçerik güvenlik politikaları nedeniyle engellendi.");
                    }
                    throw new Error("API'den boş veya hatalı formatta yanıt alındı.");
                }
            } catch (error) {
                console.error('Gemini API Hatası:', error);
                resultContainer.innerHTML = `<div class="bg-red-500/10 text-red-500 p-4 rounded-lg text-center"><strong>Hata!</strong> İstek işlenemedi. Detay: ${error.message}</div>`;
                return null;
            } finally {
                buttonElement.disabled = false;
                buttonElement.innerHTML = originalButtonText;
            }
        };

        const generateItinerary = async (countryName, duration, interests) => {
            const resultDiv = document.getElementById('ai-results-container');
            const triggerBtn = document.getElementById('open-itinerary-modal-btn');
            const prompt = `Lütfen "${countryName}" için ${duration} günlük, heyecan verici ve detaylı bir seyahat planı oluştur. İlgi alanları: ${interests}. Plan, her gün için Sabah, Öğle, Akşam aktiviteleri içermeli. Her aktivite için kısa ve ilgi çekici bir açıklama ekle. Cevabını Türkçe ve Markdown formatında, başlıklar ve listeler kullanarak ver. Ana başlıklar için '##', alt başlıklar için '###' kullan.`;
            
            const text = await callGeminiAPI(prompt, triggerBtn, resultDiv);
            if(text) {
                resultDiv.innerHTML = `
                   <div class="content-card p-6 rounded-2xl">
                       <div class="flex justify-between items-center mb-4">
                           <h4 class="text-2xl font-bold">İşte Macera Planın!</h4>
                           <button id="copy-itinerary-btn" class="btn btn-secondary px-3 py-1 rounded-md text-sm">Kopyala</button>
                       </div>
                       <div class="prose prose-sm sm:prose-base dark:prose-invert max-w-none">${formatGeminiResponse(text)}</div>
                   </div>`;
                document.getElementById('copy-itinerary-btn').addEventListener('click', () => copyToClipboard(text));
            }
        };

        const getCulturalTips = async (countryName) => {
            const resultDiv = document.getElementById('ai-results-container');
            const tipsBtn = document.getElementById('get-cultural-tips-btn');
            const prompt = `Türkiye'den ${countryName}'e seyahat edecek bir turist için 5 önemli kültürel ipucu ve görgü kuralı listele. İpuçları pratik, anlaşılır ve saygılı bir tonda olmalı. Örneğin, selamlaşma, bahşiş, giyim kuralları, hediyeleşme ve kaçınılması gereken hassas konular gibi başlıkları ele al. Cevabını Türkçe ve Markdown formatında ver.`;

            const text = await callGeminiAPI(prompt, tipsBtn, resultDiv);
            if(text) {
                 resultDiv.innerHTML = `
                   <div class="content-card p-6 rounded-2xl">
                       <h4 class="text-2xl font-bold mb-4">${countryName} İçin Kültürel İpuçları</h4>
                       <div class="prose prose-sm sm:prose-base dark:prose-invert max-w-none">${formatGeminiResponse(text)}</div>
                   </div>`;
            }
        };

        const generatePackingList = async (countryName, duration, season) => {
            const resultDiv = document.getElementById('ai-results-container');
            const packingBtn = document.getElementById('open-packing-list-btn');
            const prompt = `Lütfen "${countryName}" için ${duration} günlük, ${season} bir seyahate yönelik detaylı bir bavul hazırlama listesi oluştur. Listeyi Giyim, Elektronik, Kişisel Bakım ve Belgeler gibi pratik kategorilere ayır. Cevabını Türkçe ve Markdown formatında ver.`;
            
            const text = await callGeminiAPI(prompt, packingBtn, resultDiv);
            if(text) {
                 resultDiv.innerHTML = `
                   <div class="content-card p-6 rounded-2xl">
                       <h4 class="text-2xl font-bold mb-4">Bavul Hazırlama Listen</h4>
                       <div class="prose prose-sm sm:prose-base dark:prose-invert max-w-none">${formatGeminiResponse(text)}</div>
                   </div>`;
            }
        };

        const getAiDestinationSuggestion = async () => {
            const userInput = aiPromptInput.value;
            if (!userInput.trim()) {
                showInfoModal("Eksik Bilgi", "Lütfen nasıl bir tatil istediğinizi anlatan kısa bir metin girin.");
                return;
            }
            const prompt = `Ben bir seyahat planlama asistanıyım. Kullanıcı şu şekilde bir seyahat istiyor: "${userInput}". Bu isteğe en uygun 3 farklı ülkeyi öner. Her öneri için ülke ismini kalın harflerle yaz, altına neden uygun olduğunu 2-3 cümleyle açıkla. Cevabını sadece bu 3 öneriyi içerecek şekilde, başka bir giriş veya sonuç cümlesi olmadan, Türkçe ve Markdown formatında ver.`;
            const text = await callGeminiAPI(prompt, getAiSuggestionBtn, aiSuggestionResult);
            if (text) {
                aiSuggestionResult.innerHTML = formatGeminiResponse(text);
            }
        };
        
        const fetchCurrencyRates = async () => {
            if (currencyRates) return;
            try {
                const response = await fetch('https://api.frankfurter.app/latest?from=TRY');
                const data = await response.json();
                currencyRates = data.rates;
                currencyRates['TRY'] = 1; // Base currency
            } catch (error) {
                console.error("Döviz kurları alınamadı:", error);
                const converterContent = document.getElementById('currency-converter-content');
                if(converterContent) converterContent.innerHTML = `<p class="text-red-500">Kurlar yüklenemedi.</p>`;
            }
        };

        const initCurrencyConverter = (localCurrency) => {
            const container = document.getElementById('currency-converter-content');
            if (!currencyRates) {
                container.innerHTML = `<p class="text-red-500">Kurlar yüklenemedi.</p>`;
                return;
            }

            const currencies = Object.keys(currencyRates).sort();
            const optionsHtml = currencies.map(c => `<option value="${c}" ${c === 'TRY' ? 'selected' : ''}>${c}</option>`).join('');
            const localOptionsHtml = currencies.map(c => `<option value="${c}" ${c === localCurrency ? 'selected' : ''}>${c}</option>`).join('');

            container.innerHTML = `
                <div class="flex items-center gap-2">
                    <input type="number" id="from-amount" value="100" class="w-full p-2 rounded-lg bg-background border border-border-color">
                    <select id="from-currency" class="p-2 rounded-lg bg-background border border-border-color">${optionsHtml}</select>
                </div>
                <div class="text-center my-2 font-bold text-2xl text-accent">&darr; &uarr;</div>
                 <div class="flex items-center gap-2">
                    <input type="text" id="to-amount" readonly class="w-full p-2 rounded-lg bg-background border border-border-color">
                    <select id="to-currency" class="p-2 rounded-lg bg-background border border-border-color">${localOptionsHtml}</select>
                </div>`;
            
            const fromAmount = document.getElementById('from-amount');
            const fromCurrency = document.getElementById('from-currency');
            const toAmount = document.getElementById('to-amount');
            const toCurrency = document.getElementById('to-currency');
            
            const calculateCurrency = () => {
                const amount = parseFloat(fromAmount.value);
                const fromRate = currencyRates[fromCurrency.value];
                const toRate = currencyRates[toCurrency.value];
                if(isNaN(amount) || !fromRate || !toRate) {
                    toAmount.value = '';
                    return;
                }
                const result = (amount / fromRate) * toRate;
                toAmount.value = result.toFixed(2);
            };

            fromAmount.addEventListener('input', calculateCurrency);
            fromCurrency.addEventListener('change', calculateCurrency);
            toCurrency.addEventListener('change', calculateCurrency);
            
            calculateCurrency();
        };

        const renderChecklist = () => {
            const items = JSON.parse(localStorage.getItem('travelChecklist')) || [
                { text: "Pasaport ve Vize", completed: false, id: 1},
                { text: "Uçak Biletleri ve Konfirmasyonlar", completed: false, id: 2},
                { text: "Nakit ve Kredi Kartları", completed: false, id: 3},
                { text: "Priz Dönüştürücü (Adaptör)", completed: false, id: 4},
                { text: "Kişisel İlaçlar ve İlk Yardım Seti", completed: false, id: 5}
            ];
            
            checklistContainer.innerHTML = items.map(item => `
                <div class="checklist-item flex items-center justify-between p-3 rounded-lg bg-background ${item.completed ? 'completed' : ''}" data-id="${item.id}">
                    <div class="flex items-center">
                        <input type="checkbox" id="item-${item.id}" class="h-5 w-5 rounded border-gray-300 text-accent focus:ring-accent mr-3" ${item.completed ? 'checked' : ''}>
                        <label for="item-${item.id}" class="flex-grow">${item.text}</label>
                    </div>
                    <button class="delete-checklist-item text-gray-400 hover:text-red-500">&times;</button>
                </div>
            `).join('');

            saveChecklistState(items);
        };
        
        const saveChecklistState = (items) => {
            localStorage.setItem('travelChecklist', JSON.stringify(items));
        };
        
        const handleChecklistInteraction = (e) => {
            const items = JSON.parse(localStorage.getItem('travelChecklist'));
            const target = e.target;
            const itemDiv = target.closest('.checklist-item');
            if(!itemDiv) return;

            const itemId = parseInt(itemDiv.dataset.id, 10);

            if (target.type === 'checkbox') {
                const item = items.find(i => i.id === itemId);
                item.completed = target.checked;
            }
            if(target.classList.contains('delete-checklist-item')) {
                 const itemIndex = items.findIndex(i => i.id === itemId);
                 items.splice(itemIndex, 1);
            }
            saveChecklistState(items);
            renderChecklist();
        };

        checklistContainer.addEventListener('click', handleChecklistInteraction);
        
        addChecklistItemBtn.addEventListener('click', () => {
            const text = newChecklistItemInput.value.trim();
            if (text) {
                const items = JSON.parse(localStorage.getItem('travelChecklist'));
                items.push({ text: text, completed: false, id: Date.now() });
                saveChecklistState(items);
                renderChecklist();
                newChecklistItemInput.value = '';
            }
        });
        
        const applyTheme = (theme) => {
            document.documentElement.setAttribute('data-theme', theme);
            localStorage.setItem('theme', theme);
        };

        homeLink.addEventListener('click', (e) => {
            e.preventDefault();
            countryDetailView.classList.add('hidden');
            countryListView.classList.remove('hidden');
            searchInput.value = '';
            displayCountries();
        });
        
        suggestPlaceBtn.addEventListener('click', () => aiSuggestModal.classList.add('visible'));
        aiModalCloseBtn.addEventListener('click', () => aiSuggestModal.classList.remove('visible'));
        aiSuggestModal.addEventListener('click', (e) => {
            if (e.target === aiSuggestModal) aiSuggestModal.classList.remove('visible');
        });
        getAiSuggestionBtn.addEventListener('click', getAiDestinationSuggestion);

        checklistBtn.addEventListener('click', () => {
            renderChecklist();
            checklistModal.classList.add('visible');
        });
        checklistModalCloseBtn.addEventListener('click', () => checklistModal.classList.remove('visible'));
        checklistModal.addEventListener('click', (e) => {
            if (e.target === checklistModal) checklistModal.classList.remove('visible');
        });

        itineraryModalCloseBtn.addEventListener('click', () => itineraryModal.classList.remove('visible'));
        itineraryModal.addEventListener('click', (e) => {
            if (e.target === itineraryModal) itineraryModal.classList.remove('visible');
        });
        
        themeSwitcherBtn.addEventListener('click', () => {
            themeModal.classList.add('visible');
        });

        themeModalCloseBtn.addEventListener('click', () => {
            themeModal.classList.remove('visible');
        });

        themeModal.addEventListener('click', (e) => {
            if (e.target === themeModal) themeModal.classList.remove('visible');
        });
        
        document.querySelectorAll('.theme-option-btn').forEach(button => {
            button.addEventListener('click', () => {
                const theme = button.dataset.theme;
                applyTheme(theme);
                themeModal.classList.remove('visible');
            });
        });

        searchInput.addEventListener('input', (e) => displayCountries(e.target.value));
        
        modalCloseBtn.addEventListener('click', () => {
            infoModal.classList.remove('visible');
        });
        infoModal.addEventListener('click', (e) => {
            if (e.target === infoModal) infoModal.classList.remove('visible');
        });

        const initApp = async () => {
            const savedTheme = localStorage.getItem('theme') || 'light';
            applyTheme(savedTheme);
            await fetchCurrencyRates();
            displayCountries();

            try {
                (adsbygoogle = window.adsbygoogle || []).push({});
            } catch (e) {
                console.error("AdSense push error:", e);
            }
            
            setTimeout(() => {
                preloader.style.opacity = '0';
                preloader.addEventListener('transitionend', () => preloader.remove());
            }, 500);
        };
        
        initApp();

    });
    </script>
</body>
</html>

