<!DOCTYPE html>
<html lang="tr" data-theme="light"> <!-- Varsayƒ±lan tema -->
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vuelina | Akƒ±llƒ± Seyahat Rehberi</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@700&display=swap" rel="stylesheet">
    <link rel="icon" type="image/svg+xml" href="/favicon.svg">
    <!-- Google AdSense Kodu -->
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9708298035800838"
     crossorigin="anonymous"></script>

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-E483B9402G"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-E483B9402G');
    </script>

    <style>
        :root {
            --background: #F8F9FA;
            --card-bg: #FFFFFF;
            --text-primary: #18181B;
            --text-secondary: #71717A;
            --accent: #4F46E5;
            --accent-dark: #4338CA;
            --border-color: #E4E4E7;
            --shadow-color: rgba(0, 0, 0, 0.05);
        }

        html[data-theme='dark'] {
            --background: #121212;
            --card-bg: #1E1E1E;
            --text-primary: #FAFAFA;
            --text-secondary: #A1A1AA;
            --accent: #818CF8;
            --accent-dark: #6366F1;
            --border-color: #27272A;
            --shadow-color: rgba(0, 0, 0, 0.2);
        }

        /* YENƒ∞: Sunset Temasƒ± */
        html[data-theme='sunset'] {
            --background: #1c192e;
            --card-bg: #2d2a45;
            --text-primary: #f5e8f1;
            --text-secondary: #b0a5c4;
            --accent: #ff8e6e;
            --accent-dark: #e67e62;
            --border-color: #4a466b;
            --shadow-color: rgba(0, 0, 0, 0.2);
        }
        
        /* YENƒ∞: Forest Temasƒ± */
        html[data-theme='forest'] {
            --background: #f0f4f0;
            --card-bg: #ffffff;
            --text-primary: #1e3a24;
            --text-secondary: #5a6e60;
            --accent: #3a8a5b;
            --accent-dark: #2f6f4a;
            --border-color: #d8e0d8;
            --shadow-color: rgba(0, 0, 0, 0.05);
        }
        
        /* YENƒ∞: Ocean Temasƒ± */
        html[data-theme='ocean'] {
            --background: #eef7ff;
            --card-bg: #ffffff;
            --text-primary: #0f3460;
            --text-secondary: #537895;
            --accent: #16c79a;
            --accent-dark: #12a27e;
            --border-color: #d1e3f3;
            --shadow-color: rgba(0, 0, 0, 0.05);
        }

        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--background);
            color: var(--text-primary);
            transition: background-color 0.3s ease, color 0.3s ease;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }
        
        .logo-font {
            font-family: 'Plus Jakarta Sans', sans-serif;
        }

        .content-card {
            background-color: var(--card-bg);
            border: 1px solid var(--border-color);
            box-shadow: 0 4px 12px var(--shadow-color);
            transition: all 0.3s ease;
            border-radius: 20px;
        }
        
        header { 
            position: sticky; top: 0; z-index: 50; 
            background-color: rgba(248, 249, 250, 0.8);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border-bottom: 1px solid var(--border-color);
        }

        html[data-theme='dark'] header { background-color: rgba(18, 18, 18, 0.8); }
        html[data-theme='sunset'] header { background-color: rgba(28, 25, 46, 0.8); }
        html[data-theme='forest'] header { background-color: rgba(240, 244, 240, 0.8); }
        html[data-theme='ocean'] header { background-color: rgba(238, 247, 255, 0.8); }
        
        .country-card { 
            transition: transform 0.3s ease, box-shadow 0.3s ease; 
        }
        .country-card:hover { 
            transform: translateY(-8px); 
            box-shadow: 0 10px 25px var(--shadow-color);
        }

        .tab-button { 
            transition: all 0.2s ease; 
            border-bottom: 2px solid transparent;
            padding: 1rem 0.25rem;
        }
        .tab-button.active { color: var(--accent); border-bottom-color: var(--accent); }
        .tab-content { display: none; }
        .tab-content.active { display: block; animation: fadeInAnimation 0.4s ease forwards; }
        
        .modal-overlay { 
            position: fixed; top: 0; left: 0; right: 0; bottom: 0; 
            background-color: rgba(0, 0, 0, 0.4); 
            backdrop-filter: blur(4px); 
            z-index: 100; display: flex; align-items: center; justify-content: center; 
            opacity: 0; transition: opacity 0.3s ease; pointer-events: none; 
        }
        .modal-overlay.visible { opacity: 1; pointer-events: auto; }
        .modal-content { transform: scale(0.95) translateY(10px); transition: transform 0.3s cubic-bezier(0.2, 0.8, 0.2, 1); }
        .modal-overlay.visible .modal-content { transform: scale(1) translateY(0); }
        
        #preloader { 
            position: fixed; top: 0; left: 0; right: 0; bottom: 0; 
            background-color: var(--background); 
            z-index: 9999; display: flex; align-items: center; justify-content: center; 
            transition: opacity 0.5s ease; 
        }
        
        @keyframes fadeInAnimation { from { opacity: 0; } to { opacity: 1; } }
        
        .btn { 
            transition: all 0.2s ease; 
            border-radius: 12px;
            font-weight: 600;
        }
        .btn:disabled { opacity: 0.5; cursor: not-allowed; transform: none; box-shadow: none;}
        .btn-primary { 
            background-color: var(--accent); 
            color: white; 
        }
        .btn-primary:hover:not(:disabled) { 
            background-color: var(--accent-dark); 
            transform: translateY(-2px); 
            box-shadow: 0 6px 15px rgba(79, 70, 229, 0.2);
        }
        .btn-secondary { 
            background-color: var(--card-bg); 
            border: 1px solid var(--border-color); 
            color: var(--text-primary);
        }
        .btn-secondary:hover { 
            border-color: var(--accent);
            color: var(--accent);
        }

        html.dark input,
        html.dark textarea,
        html.dark select {
            color: var(--text-primary);
            background-color: var(--background);
            border-color: var(--border-color);
        }
        html.dark input::placeholder,
        html.dark textarea::placeholder {
            color: var(--text-secondary);
        }

        /* Tema Deƒüi≈üikliƒüi */
        input, textarea, select {
            background-color: var(--background);
            border-color: var(--border-color);
            color: var(--text-primary);
        }
        input::placeholder, textarea::placeholder {
            color: var(--text-secondary);
        }

        #search-input:focus {
            background-color: var(--card-bg);
            box-shadow: 0 0 0 3px color-mix(in srgb, var(--accent) 30%, transparent);
            border-color: var(--accent);
        }
        .checklist-item { transition: all 0.2s ease; }
        .checklist-item.completed { opacity: 0.5; }
        .checklist-item.completed label { text-decoration: line-through; }
        
        /* Geli≈ütirilmi≈ü Reklam Alanƒ± */
        .ad-placeholder {
            background-color: var(--background);
            border: 1px dashed var(--border-color);
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            color: var(--text-secondary);
            font-size: 0.8rem;
            min-height: 100px;
            border-radius: 16px;
        }
    </style>
</head>
<body class="min-h-screen flex flex-col">
    
    <div id="preloader" class="fade-in">
         <svg class="h-12 w-12" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
             <defs>
                 <linearGradient id="logo-gradient-preloader" gradientTransform="rotate(45)">
                     <stop offset="0%" stop-color="var(--accent)"/>
                     <stop offset="100%" stop-color="var(--accent-dark)"/>
                 </linearGradient>
             </defs>
             <path d="M12 2L3 22L12 17L21 22L12 2Z" fill="url(#logo-gradient-preloader)"/>
         </svg>
    </div>
    
    <header>
        <div class="container mx-auto px-4 py-4 flex justify-between items-center">
            <a href="#" id="home-link" class="flex items-center gap-3">
                <svg class="h-8 w-8" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <defs>
                        <linearGradient id="logo-gradient-header" gradientTransform="rotate(45)">
                            <stop offset="0%" stop-color="var(--accent)"/>
                            <stop offset="100%" stop-color="var(--accent-dark)"/>
                        </linearGradient>
                    </defs>
                    <path d="M12 2L3 22L12 17L21 22L12 2Z" fill="url(#logo-gradient-header)"/>
                </svg>
                <h1 class="text-2xl font-bold tracking-tighter logo-font">vuelina</h1>
            </a>
            <!-- YENƒ∞: Navigasyon Men√ºs√º -->
            <nav class="hidden md:flex items-center gap-6 text-sm font-semibold">
                <a href="#" class="text-secondary hover:text-primary transition-colors">Ana Sayfa</a>
                <a href="#" class="text-secondary hover:text-primary transition-colors">Blog</a>
                <a href="#" class="text-secondary hover:text-primary transition-colors">Hakkƒ±mƒ±zda</a>
                <a href="#" class="text-secondary hover:text-primary transition-colors">ƒ∞leti≈üim</a>
            </nav>
            <div class="flex items-center gap-2">
                <button id="checklist-btn" class="p-2 rounded-full focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-accent btn-secondary" title="Seyahat Listem">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline><line x1="16" y1="13" x2="8" y2="13"></line><line x1="16" y1="17" x2="8" y2="17"></line><polyline points="10 9 9 9 8 9"></polyline></svg>
                </button>
                <!-- YENƒ∞: Tema Deƒüi≈ütirici Butonu -->
                <button id="theme-switcher-btn" class="p-2 rounded-full focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-accent btn-secondary" title="Temayƒ± Deƒüi≈ütir">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 2.69l5.66 5.66a8 8 0 1 1-11.31 0z"></path></svg>
                </button>
            </div>
        </div>
    </header>

    <main class="container mx-auto px-4 py-10 sm:py-12 flex-grow">
        <div id="country-list-view">
            <div class="text-center mb-16">
                <h2 class="text-5xl md:text-6xl font-extrabold tracking-tight">Hayalindeki Macerayƒ± Bul</h2>
                <p class="text-lg md:text-xl text-secondary mt-4 max-w-2xl mx-auto">D√ºnyanƒ±n en pop√ºler destinasyonlarƒ±nƒ± ke≈üfet veya yapay zekanƒ±n sana √∂zel bir rota √ßizmesine izin ver.</p>
                <button id="suggest-place-btn" class="btn btn-primary mt-8 py-3 px-8 text-lg">
                    ‚ú® Bana Bir Yer √ñner
                </button>
            </div>
            
            <!-- YENƒ∞: Blog B√∂l√ºm√º (AdSense i√ßin i√ßerik zenginle≈ütirme) -->
            <section class="mb-16">
                <h3 class="text-3xl font-bold mb-6 text-center">ƒ∞lham Veren Yazƒ±lar</h3>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                    <!-- √ñrnek Blog Kartƒ± 1 -->
                    <div class="content-card overflow-hidden group">
                        <img src="https://placehold.co/600x400/818CF8/ffffff?text=Ke≈üfet" alt="Blog Image" class="w-full h-48 object-cover group-hover:scale-105 transition-transform duration-300">
                        <div class="p-6">
                            <p class="text-sm text-secondary mb-1">SEYAHAT ƒ∞PU√áLARI</p>
                            <h4 class="text-xl font-bold mb-2">Tek Ba≈üƒ±na Seyahat Etmenin Altƒ±n Kurallarƒ±</h4>
                            <a href="#" class="font-semibold text-accent hover:text-accent-dark">Devamƒ±nƒ± Oku ‚Üí</a>
                        </div>
                    </div>
                    <!-- √ñrnek Blog Kartƒ± 2 -->
                    <div class="content-card overflow-hidden group">
                        <img src="https://placehold.co/600x400/4F46E5/ffffff?text=Vuelina" alt="Blog Image" class="w-full h-48 object-cover group-hover:scale-105 transition-transform duration-300">
                        <div class="p-6">
                            <p class="text-sm text-secondary mb-1">GASTRONOMƒ∞</p>
                            <h4 class="text-xl font-bold mb-2">ƒ∞talya'da Mutlaka Tatmanƒ±z Gereken 5 Lezzet</h4>
                            <a href="#" class="font-semibold text-accent hover:text-accent-dark">Devamƒ±nƒ± Oku ‚Üí</a>
                        </div>
                    </div>
                     <!-- √ñrnek Blog Kartƒ± 3 -->
                    <div class="content-card overflow-hidden group">
                        <img src="https://placehold.co/600x400/ff8e6e/ffffff?text=Rota" alt="Blog Image" class="w-full h-48 object-cover group-hover:scale-105 transition-transform duration-300">
                        <div class="p-6">
                            <p class="text-sm text-secondary mb-1">ROTA √ñNERƒ∞Sƒ∞</p>
                            <h4 class="text-xl font-bold mb-2">Vizesiz Gidebileceƒüiniz 10 Harika Balkan √úlkesi</h4>
                            <a href="#" class="font-semibold text-accent hover:text-accent-dark">Devamƒ±nƒ± Oku ‚Üí</a>
                        </div>
                    </div>
                </div>
            </section>


            <div class="sticky top-[73px] z-40 mb-10 py-2" style="background: linear-gradient(to bottom, var(--background) 80%, transparent 100%);">
                 <div class="max-w-2xl mx-auto">
                     <h3 class="text-3xl font-bold mb-4 text-center">T√ºm √úlkeleri Ke≈üfet</h3>
                     <input type="text" id="search-input" class="w-full p-4 rounded-xl border border-border-color focus:outline-none" placeholder="Bir √ºlke ara (√∂rn: Japonya)...">
                 </div>
            </div>

            <div id="country-list-container" class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6">
            </div>
            <div id="no-results" class="hidden text-center py-16 content-card">
                <p class="text-5xl mb-4">üó∫Ô∏è</p>
                <h3 class="text-2xl font-bold">Sonu√ß Bulunamadƒ±</h3>
                <p class="text-secondary">Farklƒ± bir anahtar kelimeyle tekrar dene.</p>
            </div>
        </div>

        <div id="country-detail-view" class="hidden">
        </div>
    </main>
    
    <!-- Geli≈ütirilmi≈ü Footer (AdSense i√ßin √∂nemli) -->
    <footer class="text-center py-8 border-t border-border-color mt-12 bg-card-bg">
        <div class="container mx-auto px-4">
            <div class="ad-placeholder p-4 max-w-3xl mx-auto mb-8">
                 <!-- Reklam Alanƒ± -->
                <ins class="adsbygoogle"
                     style="display:block"
                     data-ad-client="ca-pub-9708298035800838"
                     data-ad-slot="YOUR_AD_SLOT_ID"
                     data-ad-format="auto"
                     data-full-width-responsive="true"></ins>
            </div>
            <div class="flex justify-center gap-6 mb-6">
                <a href="#" class="text-sm text-secondary hover:text-primary">Hakkƒ±mƒ±zda</a>
                <a href="#" class="text-sm text-secondary hover:text-primary">ƒ∞leti≈üim</a>
                <a href="#" class="text-sm text-secondary hover:text-primary">Gizlilik Politikasƒ±</a>
                <a href="#" class="text-sm text-secondary hover:text-primary">Kullanƒ±m ≈ûartlarƒ±</a>
            </div>
            <p class="text-sm text-secondary">&copy; 2025 Vuelina </p>
        </div>
    </footer>

    <!-- Modallar -->
    <div id="info-modal" class="modal-overlay" aria-modal="true" role="dialog">
      <div class="modal-content content-card w-full max-w-md p-8 text-center">
          <h3 id="modal-title" class="text-2xl font-bold mb-2">Ba≈ülƒ±k</h3>
          <p id="modal-text" class="text-secondary mb-6">Metin.</p>
          <button id="modal-close-btn" class="btn btn-primary w-full py-3">Anladƒ±m</button>
      </div>
    </div>
    
    <div id="ai-suggest-modal" class="modal-overlay" aria-modal="true" role="dialog">
        <div class="modal-content content-card w-full max-w-2xl p-8">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-2xl font-bold">‚ú® Yapay Zeka Seyahat Danƒ±≈ümanƒ±</h3>
                <button id="ai-modal-close-btn" class="text-2xl text-gray-400 hover:text-gray-800 dark:hover:text-white">&times;</button>
            </div>
            <div id="ai-suggestion-form">
                <p class="text-secondary mb-4">Nasƒ±l bir macera aradƒ±ƒüƒ±nƒ± anlat, sana en uygun 3 yeri √∂nereyim.</p>
                <textarea id="ai-prompt-input" rows="4" class="w-full p-3 mb-4 rounded-lg bg-background border border-border-color focus:outline-none focus:ring-2 focus:ring-accent" placeholder="√ñrnek: Aralƒ±k ayƒ±nda, bir haftalƒ±ƒüƒ±na, romantik ve tarihi bir gezi arƒ±yorum. √áok pahalƒ± olmasƒ±n."></textarea>
                <button id="get-ai-suggestion-btn" class="btn btn-primary w-full py-3 text-lg">√ñnerileri Getir</button>
            </div>
            <div id="ai-suggestion-result" class="mt-4 prose dark:prose-invert max-w-none"></div>
        </div>
    </div>

    <div id="checklist-modal" class="modal-overlay" aria-modal="true" role="dialog">
        <div class="modal-content content-card w-full max-w-2xl p-8">
            <div class="flex justify-between items-center mb-6">
                <h3 class="text-2xl font-bold">‚úàÔ∏è Seyahat Kontrol Listem</h3>
                <button id="checklist-modal-close-btn" class="text-2xl text-gray-400 hover:text-gray-800 dark:hover:text-white">&times;</button>
            </div>
            <div id="checklist-container" class="space-y-3 max-h-[50vh] overflow-y-auto pr-2"></div>
            <div class="flex gap-2 mt-4">
                <input type="text" id="new-checklist-item-input" class="w-full p-3 rounded-lg bg-background border border-border-color focus:outline-none focus:ring-2 focus:ring-accent" placeholder="Yeni g√∂rev ekle...">
                <button id="add-checklist-item-btn" class="btn btn-primary px-5 flex-shrink-0">Ekle</button>
            </div>
        </div>
    </div>

    <div id="itinerary-modal" class="modal-overlay" aria-modal="true" role="dialog">
        <div class="modal-content content-card w-full max-w-2xl p-8">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-2xl font-bold">üó∫Ô∏è Seyahat Planƒ± Olu≈ütur</h3>
                <button id="itinerary-modal-close-btn" class="text-2xl text-gray-400 hover:text-gray-800 dark:hover:text-white">&times;</button>
            </div>
            <div id="itinerary-form">
                <p class="text-secondary mb-4" id="itinerary-modal-subtitle"></p>
                <div class="grid grid-cols-1 sm:grid-cols-2 gap-4 mb-4">
                    <input type="number" id="itinerary-duration" value="3" min="1" class="w-full p-3 rounded-lg bg-background border border-border-color" placeholder="Seyahat s√ºresi (g√ºn)">
                    <input type="text" id="itinerary-interests" class="w-full p-3 rounded-lg bg-background border border-border-color" placeholder="ƒ∞lgi alanlarƒ±n (√∂rn: tarih, yemek)">
                </div>
                <button id="get-itinerary-btn" class="btn btn-primary w-full py-3 text-lg">Planƒ± Olu≈ütur</button>
            </div>
        </div>
    </div>

    <!-- YENƒ∞: Tema Se√ßim Modalƒ± -->
    <div id="theme-modal" class="modal-overlay" aria-modal="true" role="dialog">
      <div class="modal-content content-card w-full max-w-sm p-6">
          <div class="flex justify-between items-center mb-4">
            <h3 class="text-xl font-bold">Tema Se√ß</h3>
            <button id="theme-modal-close-btn" class="text-2xl text-gray-400 hover:text-gray-800 dark:hover:text-white">&times;</button>
          </div>
          <div class="grid grid-cols-2 gap-4">
            <button class="theme-option-btn p-4 rounded-lg text-left" data-theme="light">
              <div class="w-full h-12 bg-[#F8F9FA] border border-[#E4E4E7] rounded-md mb-2"></div>
              A√ßƒ±k Tema
            </button>
            <button class="theme-option-btn p-4 rounded-lg text-left" data-theme="dark">
              <div class="w-full h-12 bg-[#121212] border border-[#27272A] rounded-md mb-2"></div>
              Koyu Tema
            </button>
            <button class="theme-option-btn p-4 rounded-lg text-left" data-theme='sunset'>
              <div class="w-full h-12 bg-[#1c192e] border border-[#4a466b] rounded-md mb-2"></div>
              G√ºn Batƒ±mƒ±
            </button>
            <button class="theme-option-btn p-4 rounded-lg text-left" data-theme="forest">
              <div class="w-full h-12 bg-[#f0f4f0] border border-[#d8e0d8] rounded-md mb-2"></div>
              Orman
            </button>
             <button class="theme-option-btn p-4 rounded-lg text-left" data-theme="ocean">
              <div class="w-full h-12 bg-[#eef7ff] border border-[#d1e3f3] rounded-md mb-2"></div>
              Okyanus
            </button>
          </div>
      </div>
    </div>
    
    <script>
    // --- UYGULAMA BA≈ûLANGICI ---
    document.addEventListener('DOMContentLoaded', () => {
    
        // --- Sabitler ve DOM Elementleri ---
        const countryListView = document.getElementById('country-list-view');
        const countryDetailView = document.getElementById('country-detail-view');
        const countryListContainer = document.getElementById('country-list-container');
        const searchInput = document.getElementById('search-input');
        const noResults = document.getElementById('no-results');
        const preloader = document.getElementById('preloader');
        const themeSwitcherBtn = document.getElementById('theme-switcher-btn');
        const themeModal = document.getElementById('theme-modal');
        const themeModalCloseBtn = document.getElementById('theme-modal-close-btn');
        const infoModal = document.getElementById('info-modal');
        const modalTitle = document.getElementById('modal-title');
        const modalText = document.getElementById('modal-text');
        const modalCloseBtn = document.getElementById('modal-close-btn');
        const homeLink = document.getElementById('home-link');
        const suggestPlaceBtn = document.getElementById('suggest-place-btn');
        const aiSuggestModal = document.getElementById('ai-suggest-modal');
        const aiModalCloseBtn = document.getElementById('ai-modal-close-btn');
        const getAiSuggestionBtn = document.getElementById('get-ai-suggestion-btn');
        const aiPromptInput = document.getElementById('ai-prompt-input');
        const aiSuggestionResult = document.getElementById('ai-suggestion-result');
        const checklistBtn = document.getElementById('checklist-btn');
        const checklistModal = document.getElementById('checklist-modal');
        const checklistModalCloseBtn = document.getElementById('checklist-modal-close-btn');
        const checklistContainer = document.getElementById('checklist-container');
        const newChecklistItemInput = document.getElementById('new-checklist-item-input');
        const addChecklistItemBtn = document.getElementById('add-checklist-item-btn');
        const itineraryModal = document.getElementById('itinerary-modal');
        const itineraryModalCloseBtn = document.getElementById('itinerary-modal-close-btn');
        const getItineraryBtn = document.getElementById('get-itinerary-btn');
        
        let currencyRates = null;

        const icons = {
            sun: `<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"></circle><line x1="12" y1="1" x2="12" y2="3"></line><line x1="12" y1="21" x2="12" y2="23"></line><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line><line x1="1" y1="12" x2="3" y2="12"></line><line x1="21" y1="12" x2="23" y2="12"></line><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line></svg>`,
            moon: `<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path></svg>`,
            map: `<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"></path><circle cx="12" cy="10" r="3"></circle></svg>`,
            utensils: `<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M3 2v7c0 1.1.9 2 2 2h4a2 2 0 0 0 2-2V2"></path><path d="M7 2v20"></path><path d="M21 15V2v0a5 5 0 0 0-5 5v6c0 1.1.9 2 2 2h3z"></path></svg>`,
            bed: `<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M2 4v16h20V4Z"></path><path d="M2 10h20"></path><path d="M6 14v-4"></path></svg>`,
            info: `<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><line x1="12" y1="16" x2="12" y2="12"></line><line x1="12" y1="8" x2="12.01" y2="8"></line></svg>`,
            smartphone: `<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="5" y="2" width="14" height="20" rx="2" ry="2"></rect><line x1="12" y1="18" x2="12.01" y2="18"></line></svg>`,
            tools: `<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z"></path></svg>`,
            fastfood: `<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 11v1a3 3 0 0 0 3 3h10a3 3 0 0 0 3-3v-1"></path><path d="M17 11V7.1a2 2 0 0 0-2-2H9a2 2 0 0 0-2 2V11"></path><path d="M7 11v-2.5a1.5 1.5 0 1 1 3 0V11"></path><path d="M14 11v-2.5a1.5 1.5 0 1 1 3 0V11"></path></svg>`
        };
        
        const countriesData = {
            "T√ºrkiye": { flag: "üáπüá∑", description: "Tarihi ve doƒüal g√ºzellikleriyle √ºnl√º, Asya ve Avrupa kƒ±talarƒ±nƒ± birle≈ütiren e≈üsiz bir √ºlke.", searchTerms: { flights: 'Turkiye', booking: 'Turkey' }, whatToDo: ["Ayasofya & Sultanahmet'i ke≈üfet", "Kapadokya'da sƒ±cak hava balonuyla u√ß", "Pamukkale travertenlerinde y√ºr√º", "Efes Antik Kenti'nin tarihini hisset"], whatToEat: ["Zengin Kebap √ße≈üitleri", "Antep Baklavasƒ±", "Serpme Kahvaltƒ±", "Meze k√ºlt√ºr√º ve Rakƒ±"], whereToStay: ["ƒ∞stanbul: Tarihi Yarƒ±mada veya Karak√∂y", "Kapadokya: Otantik maƒüara oteller", "Ege/Akdeniz: Butik oteller ve resortlar"], popularApps: [{name: "Getir", category: "Market & Yemek"}, {name: "BiTaksi", category: "Ula≈üƒ±m"}, {name: "Yemeksepeti", category: "Yemek Sipari≈üi"}, {name: "Google Maps", category: "Navigasyon"}], fastFoodChains: ["McDonald's", "Burger King", "Popeyes", "Usta D√∂nerci"], currency: "TRY", language: "T√ºrk√ße", emergencyNumber: "112", basicPhrases: [{tr:"Merhaba", local:"Merhaba"}, {tr:"Te≈üekk√ºrler", local:"Te≈üekk√ºrler"}], climate: "Genel olarak Akdeniz iklimi hakimdir; yazlar sƒ±cak ve kurak, kƒ±≈ülar ƒ±lƒ±man ve yaƒüƒ±≈ülƒ± ge√ßer." },
            "ƒ∞talya": { flag: "üáÆüáπ", description: "Sanat, tarih, moda ve muhte≈üem yemekleriyle bilinen bir Akdeniz √ºlkesi.", searchTerms: { flights: 'Italya', booking: 'Italy' }, whatToDo: ["Roma'da Kolezyum ve Antik Forum'u gez", "Venedik kanallarƒ±nda gondol turu yap", "Floransa'da R√∂nesans sanatƒ±nƒ± ke≈üfet", "Amalfi Sahillerinin manzarasƒ±na doy"], whatToEat: ["Napoli'de odun ate≈üinde Pizza", "Taze ev yapƒ±mƒ± Makarna (Pasta Fresca)", "Ger√ßek ƒ∞talyan Dondurmasƒ± (Gelato)", "Espresso ve Tiramisu"], whereToStay: ["Roma: Tarihi merkez (Centro Storico)", "Toskana: Kƒ±rsal agriturismo √ßiftlik evleri", "Venedik: Kanallara bakan oteller"], popularApps: [{name: "Trenitalia", category: "Tren"}, {name: "TheFork", category: "Restoran Rezervasyon"}, {name: "FREE NOW", category: "Taksi"}, {name: "Booking.com", category: "Konaklama"}], fastFoodChains: ["McDonald's", "Burger King", "KFC", "Spizzico"], currency: "EUR", language: "ƒ∞talyanca", emergencyNumber: "112", basicPhrases: [{tr:"Merhaba", local:"Ciao"}, {tr:"Te≈üekk√ºrler", local:"Grazie"}], climate: "Akdeniz iklimi. Kuzeyde kƒ±≈ülar daha soƒüuk ve kar yaƒüƒ±≈ülƒ± olabilir." },
            "Japonya": { flag: "üáØüáµ", description: "Geleneksel k√ºlt√ºr√º ve f√ºt√ºristik teknolojiyi bir arada sunan b√ºy√ºleyici bir ada √ºlkesi.", searchTerms: { flights: 'Japonya', booking: 'Japan' }, whatToDo: ["Tokyo'da Shibuya Ge√ßidi'nin kalabalƒ±ƒüƒ±na karƒ±≈ü", "Kyoto'nun bambu ormanlarƒ±nda y√ºr√º", "Fuji Daƒüƒ±'nƒ±n g√∂rkemini izle", "Osaka'da sokak lezzetlerini tat"], whatToEat: ["Usta elinden Su≈üi ve Sashimi", "Sƒ±cak bir kase Ramen", "Hafif ve √ßƒ±tƒ±r Tempura", "Japon ye≈üil √ßayƒ± (Matcha)"], whereToStay: ["Tokyo: Shinjuku veya Shibuya b√∂lgeleri", "Kyoto: Geleneksel Ryokan'lar", "Osaka: Namba'da modern oteller"], popularApps: [{name: "Jorudan", category: "Tren & Rota"}, {name: "Gurunavi", category: "Restoran Bulucu"}, {name: "Go", category: "Taksi"}, {name: "Google Translate", category: "√áeviri"}], fastFoodChains: ["McDonald's", "KFC", "Mos Burger", "Yoshinoya"], currency: "JPY", language: "Japonca", emergencyNumber: "110 (Polis), 119 (Ambulans/ƒ∞tfaiye)", basicPhrases: [{tr:"Merhaba", local:"„Åì„Çì„Å´„Å°„ÅØ (Konnichiwa)"}, {tr:"Te≈üekk√ºrler", local:"„ÅÇ„Çä„Åå„Å®„ÅÜ (Arigatou)"}], climate: "D√∂rt mevsim belirgin ya≈üanƒ±r. Yazlar sƒ±cak ve nemli, kƒ±≈ülar soƒüuk ve kar yaƒüƒ±≈ülƒ±dƒ±r." },
            "Fransa": { flag: "üá´üá∑", description: "Moda, sanat, gastronomi ve romantizmin ba≈ükenti.", searchTerms: { flights: 'Fransa', booking: 'France' }, whatToDo: ["Eyfel Kulesi'nden Paris'i izle", "Louvre M√ºzesi'nde Mona Lisa'yƒ± g√∂r", "Mont Saint-Michel'in masalsƒ± atmosferini ya≈üa", "Provence'da lavanta tarlalarƒ±nƒ± gez"], whatToEat: ["Fƒ±rƒ±ndan taze √ßƒ±kmƒ±≈ü Kruvasan", "Fransƒ±z peynirleri ve ≈üaraplarƒ±", "Renkli Makaronlar", "Soƒüan √áorbasƒ±"], whereToStay: ["Paris: Le Marais veya Saint-Germain", "Fransƒ±z Rivierasƒ±: Nice veya Cannes", "Provence: ≈ûato oteller"], popularApps: [{name: "SNCF Connect", category: "Tren & Otob√ºs"}, {name: "TheFork", category: "Restoran Rezervasyon"}, {name: "Bonjour RATP", category: "Paris Ula≈üƒ±m"}, {name: "Uber", category: "Ula≈üƒ±m"}], fastFoodChains: ["McDonald's", "Burger King", "Quick", "KFC"], currency: "EUR", language: "Fransƒ±zca", emergencyNumber: "112", basicPhrases: [{tr:"Merhaba", local:"Bonjour"}, {tr:"Te≈üekk√ºrler", local:"Merci"}], climate: "Ilƒ±man iklim. G√ºneyde Akdeniz iklimi, Alpler'de daƒü iklimi g√∂r√ºl√ºr." },
            "Birle≈üik Krallƒ±k": { flag: "üá¨üáß", description: "Tarih, kraliyet gelenekleri, modern k√ºlt√ºr ve ye≈üil kƒ±rsal alanlarƒ±n birle≈ütiƒüi bir ada √ºlkesi.", searchTerms: { flights: 'Birlesik-Krallik', booking: 'United-Kingdom' }, whatToDo: ["Londra'da Buckingham Sarayƒ± ve Tower Bridge'i g√∂r", "Edinburgh Kalesi'ni ke≈üfet", "Stonehenge'in gizemini √ß√∂z", "ƒ∞sko√ßya'nƒ±n Highlands b√∂lgesinde doƒüa y√ºr√ºy√º≈ü√º yap"], whatToEat: ["Fish and Chips", "Sunday Roast (Pazar Yemeƒüi)", "Full English Breakfast", "Afternoon Tea (Be≈ü √áayƒ±)"], whereToStay: ["Londra: Covent Garden veya South Kensington", "Edinburgh: Old Town'daki tarihi oteller", "Cotswolds: Geleneksel 'inn'ler"], popularApps: [{name: "Citymapper", category: "Ula≈üƒ±m"}, {name: "Trainline", category: "Tren Bileti"}, {name: "Just Eat", category: "Yemek Sipari≈üi"}, {name: "Uber", category: "Ula≈üƒ±m"}], fastFoodChains: ["McDonald's", "KFC", "Burger King", "Greggs", "Subway"], currency: "GBP", language: "ƒ∞ngilizce", emergencyNumber: "999", basicPhrases: [{tr:"Merhaba", local:"Hello"}, {tr:"Te≈üekk√ºrler", local:"Thank you / Cheers"}], climate: "Ilƒ±man okyanus iklimi. Yƒ±l boyunca yaƒüƒ±≈ülƒ± ve hava durumu deƒüi≈ükendir." },
            "ABD": { flag: "üá∫üá∏", description: "√áe≈üitli k√ºlt√ºrleri ve coƒürafi √∂zellikleri barƒ±ndƒ±ran devasa bir √ºlke.", searchTerms: { flights: 'Amerika-Birlesik-Devletleri', booking: 'United-States-of-America' }, whatToDo: ["New York'un g√∂kdelenleri arasƒ±nda kaybol", "Grand Canyon'un b√ºy√ºkl√ºƒü√º kar≈üƒ±sƒ±nda ≈üa≈üƒ±r", "Route 66'da araba yolculuƒüu yap", "Miami'nin Art Deco sahillerinde y√ºr√º"], whatToEat: ["New York usul√º Pizza", "Texas usul√º Barbek√º (BBQ)", "California'dan taze Avokado Tost", "Pancakes ve ak√ßaaƒüa√ß ≈üurubu"], whereToStay: ["New York: Manhattan'da merkezi bir otel", "California: Sahil kasabalarƒ±nda butik oteller", "Ulusal Parklar: Kamping veya daƒü evleri"], popularApps: [{name: "Uber / Lyft", category: "Ula≈üƒ±m"}, {name: "Yelp", category: "Restoran & Yorum"}, {name: "DoorDash", category: "Yemek Sipari≈üi"}, {name: "Airbnb", category: "Konaklama"}], fastFoodChains: ["McDonald's", "Burger King", "Wendy's", "Taco Bell", "Subway"], currency: "USD", language: "ƒ∞ngilizce", emergencyNumber: "911", basicPhrases: [{tr:"Merhaba", local:"Hello"}, {tr:"Te≈üekk√ºrler", local:"Thank you"}], climate: "√áok √ße≈üitli iklimler. Florida'da tropikal, Alaska'da kutup iklimi g√∂r√ºlebilir." },
            "Brezilya": { flag: "üáßüá∑", description: "Amazon ormanlarƒ±, canlƒ± k√ºlt√ºr√º ve futboluyla tanƒ±nan G√ºney Amerika √ºlkesi.", searchTerms: { flights: 'Brezilya', booking: 'Brazil' }, whatToDo: ["Kurtarƒ±cƒ± ƒ∞sa Heykeli'nden Rio'yu seyret", "Amazon ormanlarƒ±nda ekolojik tur yap", "Iguazu ≈ûelaleleri'nin g√ºc√ºn√º hisset", "Salvador'un renkli sokaklarƒ±nda dans et"], whatToEat: ["Ulusal yemek Feijoada", "Churrasco barbek√º ziyafeti", "Sokak lezzeti P√£o de Queijo", "Enerji veren A√ßa√≠ kaseleri"], whereToStay: ["Rio de Janeiro: Copacabana veya Ipanema", "Amazon: S√ºrd√ºr√ºlebilir orman localarƒ±", "Salvador: Pelourinho'da tarihi konaklar"], popularApps: [{name: "99 / Uber", category: "Ula≈üƒ±m"}, {name: "iFood", category: "Yemek Sipari≈üi"}, {name: "Rappi", category: "Teslimat"}, {name: "WhatsApp", category: "ƒ∞leti≈üim"}], fastFoodChains: ["McDonald's", "Burger King", "Subway", "Bob's"], currency: "BRL", language: "Portekizce", emergencyNumber: "190 (Polis), 192 (Ambulans)", basicPhrases: [{tr:"Merhaba", local:"Ol√°"}, {tr:"Te≈üekk√ºrler", local:"Obrigado/Obrigada"}], climate: "B√ºy√ºk √∂l√ß√ºde tropikal. G√ºney b√∂lgeler daha ƒ±lƒ±mandƒ±r." },
            "Mƒ±sƒ±r": { flag: "üá™üá¨", description: "Antik medeniyetlere ev sahipliƒüi yapmƒ±≈ü, piramitleri ve Nil Nehri ile √ºnl√º.", searchTerms: { flights: 'Misir', booking: 'Egypt' }, whatToDo: ["Gize Piramitleri ve Sfenks'in gizemini √ß√∂z", "Krallar Vadisi'ndeki firavun mezarlarƒ±nƒ± ke≈üfet", "Nil Nehri'nde geleneksel Felucca ile yelken a√ß", "Dahab'da Kƒ±zƒ±ldeniz'in su altƒ± d√ºnyasƒ±nƒ± g√∂r"], whatToEat: ["Sokak yemeƒüi klasiƒüi Ko≈üari", "Ful Medames ile kahvaltƒ±", "Mƒ±sƒ±r usul√º Falafel (Ta'ameya)", "Geleneksel tatlƒ± Umm Ali"], whereToStay: ["Kahire: Nil manzaralƒ± modern oteller", "Luxor: Tarihe yakƒ±n butik oteller", "Kƒ±zƒ±ldeniz sahili: Dalƒ±≈ü ve spa resortlarƒ±"], popularApps: [{name: "Uber / Careem", category: "Ula≈üƒ±m"}, {name: "Talabat", category: "Yemek Sipari≈üi"}, {name: "Swvl", category: "Otob√ºs & Ula≈üƒ±m"}, {name: "Google Maps", category: "Navigasyon"}], fastFoodChains: ["McDonald's", "KFC", "Hardee's", "Cook Door"], currency: "EGP", language: "Arap√ßa", emergencyNumber: "122 (Polis), 123 (Ambulans)", basicPhrases: [{tr:"Merhaba", local:"ŸÖÿ±ÿ≠ÿ®ÿß (Marhaban)"}, {tr:"Te≈üekk√ºrler", local:"ÿ¥ŸÉÿ±ÿß (Shukran)"}], climate: "Sƒ±cak √ß√∂l iklimi. Kƒ±yƒ± ≈üeridi daha ƒ±lƒ±mandƒ±r." },
            "Avustralya": { flag: "üá¶üá∫", description: "E≈üsiz vah≈üi ya≈üamƒ±, mercan resifleri ve modern ≈üehirleriyle bilinen bir kƒ±ta √ºlke.", searchTerms: { flights: 'Avustralya', booking: 'Australia' }, whatToDo: ["Sydney Opera Binasƒ± √∂n√ºnde fotoƒüraf √ßek", "B√ºy√ºk Set Resifi'nde ≈ünorkelle dal", "Melbourne'√ºn sanat dolu sokaklarƒ±nda kaybol", "Uluru'da g√ºn batƒ±mƒ±nƒ± ve doƒüu≈üunu izle"], whatToEat: ["Sahilde Fish and Chips keyfi", "Avustralyalƒ±larƒ±n favorisi Vegemite on toast", "Lamington keki", "Taze deniz √ºr√ºnleri barbek√ºs√º"], whereToStay: ["Sydney: Circular Quay veya The Rocks", "Melbourne: Merkezi ƒ∞≈ü B√∂lgesi (CBD)", "Queensland: Whitsundays adalarƒ±nda resortlar"], popularApps: [{name: "Uber / DiDi", category: "Ula≈üƒ±m"}, {name: "Menulog", category: "Yemek Sipari≈üi"}, {name: "TripView", category: "Toplu Ta≈üƒ±ma"}, {name: "Airbnb", category: "Konaklama"}], fastFoodChains: ["McDonald's (Macca's)", "Hungry Jack's (Burger King)", "KFC", "Domino's"], currency: "AUD", language: "ƒ∞ngilizce", emergencyNumber: "000", basicPhrases: [{tr:"Merhaba", local:"G'day"}, {tr:"Te≈üekk√ºrler", local:"Cheers"}], climate: "G√ºneyde ƒ±lƒ±man, kuzeyde tropikal, i√ß kesimlerde √ß√∂l iklimi." },
            "ƒ∞spanya": { flag: "üá™üá∏", description: "Flamenko, tapas ve g√ºne≈üli sahilleriyle √ºnl√º canlƒ± bir Avrupa √ºlkesi.", searchTerms: { flights: 'Ispanya', booking: 'Spain' }, whatToDo: ["Barselona'da Gaudi'nin mimarisini takip et", "End√ºl√ºs'te Alhambra Sarayƒ±'nƒ± gez", "Madrid'de sanat m√ºzelerini dola≈ü", "ƒ∞biza'da g√ºne≈üin ve m√ºziƒüin tadƒ±nƒ± √ßƒ±kar"], whatToEat: ["Valensiya usul√º Paella", "√áe≈üit √ße≈üit Tapas", "Sƒ±cak √ßikolatayla Churros", "End√ºl√ºs'ten soƒüuk Gazpacho √ßorbasƒ±"], whereToStay: ["Barselona: Gotik Mahalle veya Eixample", "Madrid: Gran Via √ßevresi", "Sevilla: Santa Cruz'un dar sokaklarƒ±"], popularApps: [{name: "Cabify / FREE NOW", category: "Ula≈üƒ±m"}, {name: "Glovo", category: "Teslimat & Yemek"}, {name: "Renfe", category: "Tren"}, {name: "ElTenedor", category: "Restoran Rezervasyon"}], fastFoodChains: ["McDonald's", "Burger King", "KFC", "Telepizza"], currency: "EUR", language: "ƒ∞spanyolca", emergencyNumber: "112", basicPhrases: [{tr:"Merhaba", local:"Hola"}, {tr:"Te≈üekk√ºrler", local:"Gracias"}], climate: "Akdeniz iklimi. ƒ∞√ß kesimlerde karasal iklim etkileri g√∂r√ºl√ºr." },
            "Yunanistan": { flag: "üá¨üá∑", description: "Antik felsefenin doƒüduƒüu topraklar, binlerce ada ve masmavi deniz.", searchTerms: { flights: 'Yunanistan', booking: 'Greece' }, whatToDo: ["Atina'da Akropolis'in tepesine tƒ±rman", "Santorini'de Oia'nƒ±n me≈ühur g√ºn batƒ±mƒ±nƒ± izle", "Meteora'nƒ±n g√∂ky√ºz√ºndeki manastƒ±rlarƒ±nƒ± ziyaret et", "Girit'in e≈üsiz plajlarƒ±nƒ± ke≈üfet"], whatToEat: ["Fƒ±rƒ±nda Musakka", "Tzatziki ile Souvlaki (D√ºr√ºm)", "Yunan Salatasƒ±nda ger√ßek Feta peyniri", "Ballƒ± ve cevizli Yunan Yoƒüurdu"], whereToStay: ["Santorini: Kaldera manzaralƒ± oteller", "Atina: Plaka'nƒ±n tarihi atmosferi", "Mikonos: ≈ûehir merkezinde butik oteller"], popularApps: [{name: "Beat / FREE NOW", category: "Taksi"}, {name: "Wolt", category: "Yemek Sipari≈üi"}, {name: "Ferryhopper", category: "Feribot Biletleri"}, {name: "Booking.com", category: "Konaklama"}], fastFoodChains: ["McDonald's", "Goody's Burger House", "KFC", "Everest"], currency: "EUR", language: "Yunanca", emergencyNumber: "112", basicPhrases: [{tr:"Merhaba", local:"ŒìŒµŒπŒ¨ œÉŒøœÖ (Yia sou)"}, {tr:"Te≈üekk√ºrler", local:"ŒïœÖœáŒ±œÅŒπœÉœÑœé (Efcharist√≥)"}], climate: "Akdeniz iklimi. Adalarda yazlar sƒ±cak ve kuraktƒ±r." },
            "Tayland": { flag: "üáπüá≠", description: "Egzotik tapƒ±naklar, hareketli sokak pazarlarƒ± ve tropik adalar diyarƒ±.", searchTerms: { flights: 'Tayland', booking: 'Thailand' }, whatToDo: ["Bangkok'un y√ºzen pazarlarƒ±nda alƒ±≈üveri≈ü yap", "Chiang Mai'de bir fil sƒ±ƒüƒ±naƒüƒ±nƒ± ziyaret et", "Phi Phi Adalarƒ±'nƒ±n turkuaz sularƒ±nda y√ºz", "Ayutthaya'nƒ±n antik tapƒ±naklarƒ±nƒ± gez"], whatToEat: ["Sokak tezgahlarƒ±ndan Pad Thai", "Acƒ±lƒ± ve ek≈üili Tom Yum √ßorbasƒ±", "Tatlƒ± ve yapƒ±≈ükan Mango Sticky Rice", "Ye≈üil K√∂rili Tavuk (Green Curry)"], whereToStay: ["Bangkok: Sukhumvit veya Riverside", "Phuket: L√ºks sahil resortlarƒ±", "Chiang Mai: Eski ≈üehir i√ßindeki butik oteller"], popularApps: [{name: "Grab", category: "Ula≈üƒ±m & Yemek"}, {name: "Agoda", category: "Konaklama"}, {name: "LINE", category: "ƒ∞leti≈üim"}, {name: "Klook", category: "Aktivite & Tur"}], fastFoodChains: ["McDonald's", "KFC", "Burger King", "Chester's"], currency: "THB", language: "Tayca", emergencyNumber: "1155 (Turist Polisi)", basicPhrases: [{tr:"Merhaba", local:"‡∏™‡∏ß‡∏±‡∏™‡∏î‡∏µ (Sawasdee)"}, {tr:"Te≈üekk√ºrler", local:"‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì (Khop khun)"}], climate: "Tropikal muson iklimi. Yƒ±l boyunca sƒ±cak ve nemlidir." },
            // ... diƒüer √ºlkeler ...
        };

        const showInfoModal = (title, text) => {
            modalTitle.textContent = title;
            modalText.textContent = text;
            infoModal.classList.add('visible');
        };
        
        const formatGeminiResponse = (text) => {
            let html = '';
            const lines = text.split('\n').filter(line => line.trim() !== '');
            let inList = false;

            lines.forEach(line => {
                line = line.trim().replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>').replace(/\*(.*?)\*/g, '<em>$1</em>');
                
                if (line.startsWith('###')) {
                    html += `</ul>${inList ? '</ul>' : ''}<h3 class="text-xl font-semibold mt-4 mb-2">${line.replace(/###\s*/, '')}</h3>`;
                    inList = false;
                } else if (line.startsWith('##')) {
                    html += `${inList ? '</ul>' : ''}<h2 class="text-2xl font-bold mt-5 mb-3">${line.replace(/##\s*/, '')}</h2>`;
                    inList = false;
                } else if (line.startsWith('-') || line.startsWith('*')) {
                    if (!inList) {
                        html += '<ul class="list-disc pl-5 space-y-2 mt-2">';
                        inList = true;
                    }
                    html += `<li class="text-secondary">${line.substring(1).trim()}</li>`;
                } else {
                    html += `${inList ? '</ul>' : ''}<p class="text-secondary mb-3">${line}</p>`;
                    inList = false;
                }
            });
            if (inList) html += '</ul>';
            return html;
        };

        const copyToClipboard = (text) => {
            const textArea = document.createElement("textarea");
            textArea.value = text;
            document.body.appendChild(textArea);
            textArea.select();
            try {
                document.execCommand('copy');
                showInfoModal('Ba≈üarƒ±lƒ±!', 'Seyahat planƒ± panoya kopyalandƒ±.');
            } catch (err) {
                showInfoModal('Hata!', 'Otomatik kopyalama ba≈üarƒ±sƒ±z oldu.');
            }
            document.body.removeChild(textArea);
        };
        
        const displayCountries = (filter = '') => {
            countryListContainer.innerHTML = '';
            const normalizedFilter = filter.toLowerCase().trim();
            const countryNames = Object.keys(countriesData).sort((a,b) => a.localeCompare(b, 'tr'));
            let adInserted = false;

            countryNames.forEach((name, index) => {
                if (name.toLowerCase().includes(normalizedFilter)) {
                    const country = countriesData[name];
                    const card = document.createElement('div');
                    card.className = 'country-card content-card p-6 text-center cursor-pointer';
                    card.innerHTML = `
                        <p class="text-6xl mb-4">${country.flag}</p>
                        <h3 class="text-lg font-semibold mb-1">${name}</h3>
                        <p class="text-sm text-secondary">${country.description}</p>
                    `;
                    card.addEventListener('click', () => displayCountryDetail(name));
                    countryListContainer.appendChild(card);
                }

                if (index === 7 && !adInserted && !filter) {
                    const adCard = document.createElement('div');
                    adCard.className = 'ad-placeholder content-card p-6 text-center lg:col-span-2 md:col-span-1 sm:col-span-2 col-span-1';
                     adCard.innerHTML = `
                        <ins class="adsbygoogle"
                             style="display:block; width:100%;"
                             data-ad-client="ca-pub-9708298035800838"
                             data-ad-slot="YOUR_AD_SLOT_ID_2"
                             data-ad-format="auto"
                             data-full-width-responsive="true"></ins>
                    `;
                    countryListContainer.appendChild(adCard);
                    adInserted = true;
                }
            });

            const hasResults = countryListContainer.children.length > 0;
            noResults.classList.toggle('hidden', hasResults);
        };
        
        const displayCountryDetail = (countryName) => {
            const country = countriesData[countryName];
            const popularAppsHtml = country.popularApps.map(app => `
                <li class="flex items-center">
                    <span class="font-semibold text-primary mr-2">${app.name}</span>
                    <span class="text-sm text-secondary">- ${app.category}</span>
                </li>
            `).join('');
            const fastFoodHtml = country.fastFoodChains.map(chain => `<li class="text-secondary">${chain}</li>`).join('');
            const basicPhrasesHtml = country.basicPhrases.map(phrase => `
                <li class="flex justify-between items-center">
                    <span class="text-primary">${phrase.tr}</span>
                    <span class="text-secondary font-semibold">${phrase.local}</span>
                </li>
            `).join('');

            countryListView.classList.add('hidden');
            countryDetailView.innerHTML = `
                <div class="fade-in">
                    <button id="back-to-list" class="btn btn-secondary mb-8 py-2 px-4 rounded-lg flex items-center">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="mr-2"><line x1="19" y1="12" x2="5" y2="12"></line><polyline points="12 19 5 12 12 5"></polyline></svg>
                        Geri D√∂n
                    </button>
                    <div class="content-card p-6 sm:p-10">
                        <div class="flex flex-col md:flex-row items-center text-center md:text-left mb-6">
                            <p class="text-8xl md:mr-8 mb-4 md:mb-0">${country.flag}</p>
                            <div>
                                <h2 class="text-5xl font-extrabold tracking-tight mb-2">${countryName}</h2>
                                <p class="text-lg text-secondary">${country.description}</p>
                            </div>
                        </div>

                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-8">
                            <a href="https://www.skyscanner.com.tr/ucak-biletleri-kalkis/tr/e/${country.searchTerms.flights}" target="_blank" class="btn btn-secondary flex items-center justify-center p-3">
                                ‚úàÔ∏è Uygun U√ßu≈ülarƒ± Ara
                            </a>
                            <a href="https://www.booking.com/searchresults.html?ss=${country.searchTerms.booking}" target="_blank" class="btn btn-secondary flex items-center justify-center p-3">
                                üè® Otel ve Konaklama Bul
                            </a>
                        </div>

                        <div class="border-b border-border-color mb-6">
                            <nav class="flex space-x-2 sm:space-x-4 -mb-px overflow-x-auto" id="detail-tabs">
                                <button data-tab="todo" class="tab-button active font-medium text-base sm:text-lg flex items-center flex-shrink-0">${icons.map}<span class="ml-2">Yapƒ±lacaklar</span></button>
                                <button data-tab="toeat" class="tab-button font-medium text-base sm:text-lg flex items-center flex-shrink-0">${icons.utensils}<span class="ml-2">Lezzetler</span></button>
                                <button data-tab="tostay" class="tab-button font-medium text-base sm:text-lg flex items-center flex-shrink-0">${icons.bed}<span class="ml-2">Konaklama</span></button>
                                <button data-tab="fastfood" class="tab-button font-medium text-base sm:text-lg flex items-center flex-shrink-0">${icons.fastfood}<span class="ml-2">Fast Food</span></button>
                                <button data-tab="tools" class="tab-button font-medium text-base sm:text-lg flex items-center flex-shrink-0">${icons.tools}<span class="ml-2">Ara√ßlar</span></button>
                            </nav>
                        </div>
                        
                        <div id="tab-content-container" class="text-secondary">
                            <div id="tab-todo" class="tab-content active">
                                <ul class="list-disc pl-5 space-y-2">${country.whatToDo.map(i => `<li>${i}</li>`).join('')}</ul>
                                <a href="https://www.getyourguide.com/${country.searchTerms.booking}" target="_blank" class="text-accent font-semibold inline-block mt-4">Bu b√∂lgedeki turlarƒ± ve aktiviteleri ke≈üfet ‚Üí</a>
                            </div>
                            <div id="tab-toeat" class="tab-content"><ul class="list-disc pl-5 space-y-2">${country.whatToEat.map(i => `<li>${i}</li>`).join('')}</ul></div>
                            <div id="tab-tostay" class="tab-content"><ul class="list-disc pl-5 space-y-2">${country.whereToStay.map(i => `<li>${i}</li>`).join('')}</ul></div>
                            <div id="tab-fastfood" class="tab-content"><ul class="list-disc pl-5 space-y-2">${fastFoodHtml}</ul></div>
                            <div id="tab-tools" class="tab-content space-y-8">
                                <div>
                                    <h4 class="font-bold text-lg mb-3 text-primary flex items-center">${icons.smartphone}<span class="ml-2">Pop√ºler Uygulamalar</span></h4>
                                    <ul class="space-y-3">${popularAppsHtml}</ul>
                                </div>
                                <div id="currency-converter-container">
                                    <h4 class="font-bold text-lg mb-3 text-primary">D√∂viz √áevirici</h4>
                                    <div id="currency-converter-content">Y√ºkleniyor...</div>
                                </div>
                                <div>
                                    <h4 class="font-bold text-lg mb-3 text-primary">ƒ∞klim ve Hava Durumu</h4>
                                    <p>${country.climate}</p>
                                </div>
                                <div>
                                    <h4 class="font-bold text-lg mb-3 text-primary">Temel ƒ∞fadeler</h4>
                                    <ul class="space-y-2">${basicPhrasesHtml}</ul>
                                </div>
                                 <div>
                                    <h4 class="font-bold text-lg mb-3 text-primary">Acil Durum Numarasƒ±</h4>
                                    <p class="text-2xl font-bold text-accent">${country.emergencyNumber}</p>
                                </div>
                            </div>
                        </div>

                        <div class="mt-12 pt-8 border-t border-border-color">
                             <h3 class="text-3xl font-bold text-center mb-6">‚ú® Yapay Zeka Asistanƒ±n</h3>
                             <div class="max-w-4xl mx-auto grid grid-cols-1 sm:grid-cols-3 gap-4">
                                 <div class="bg-background/50 p-6 rounded-2xl border border-border-color flex flex-col">
                                     <h4 class="font-bold text-lg mb-2">Seyahat Planƒ± Olu≈ütur</h4>
                                     <p class="text-sm text-secondary mb-3 flex-grow">S√ºre ve ilgi alanlarƒ±na g√∂re ki≈üisel rotanƒ± olu≈ütur.</p>
                                     <button id="open-itinerary-modal-btn" class="btn btn-primary w-full py-2 rounded-lg font-bold mt-auto">Planla!</button>
                                 </div>
                                 <div class="bg-background/50 p-6 rounded-2xl border border-border-color flex flex-col">
                                     <h4 class="font-bold text-lg mb-2">K√ºlt√ºrel ƒ∞pu√ßlarƒ± Al</h4>
                                     <p class="text-sm text-secondary mb-3 flex-grow">Yerel adetleri √∂ƒürenerek daha anlamlƒ± bir gezi yap.</p>
                                      <button id="get-cultural-tips-btn" class="btn btn-primary w-full py-2 rounded-lg font-bold mt-auto">ƒ∞pu√ßlarƒ± Getir</button>
                                 </div>
                                 <div class="bg-background/50 p-6 rounded-2xl border border-border-color flex flex-col">
                                     <h4 class="font-bold text-lg mb-2">Bavul Hazƒ±rlama Asistanƒ±</h4>
                                     <p class="text-sm text-secondary mb-3 flex-grow">Gideceƒüin yere ve mevsime g√∂re bavulunu hazƒ±rla.</p>
                                      <button id="open-packing-list-btn" class="btn btn-primary w-full py-2 rounded-lg font-bold mt-auto">Bavul Hazƒ±rla</button>
                                 </div>
                             </div>
                             <div id="ai-results-container" class="mt-6 max-w-3xl mx-auto"></div>
                        </div>
                    </div>
                </div>`;
            countryDetailView.classList.remove('hidden');
            window.scrollTo({ top: 0, behavior: 'smooth' });
            
            initCurrencyConverter(country.currency);

            document.getElementById('back-to-list').addEventListener('click', () => {
                countryDetailView.classList.add('hidden');
                countryListView.classList.remove('hidden');
            });
            
            const tabs = document.getElementById('detail-tabs').querySelectorAll('button');
            tabs.forEach(tab => {
                tab.addEventListener('click', () => {
                    tabs.forEach(t => t.classList.remove('active'));
                    tab.classList.add('active');
                    document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
                    document.getElementById(`tab-${tab.dataset.tab}`).classList.add('active');
                });
            });

            document.getElementById('open-itinerary-modal-btn').addEventListener('click', () => {
                document.getElementById('itinerary-modal-subtitle').textContent = `${countryName} i√ßin plan olu≈ütur.`;
                itineraryModal.classList.add('visible');
            });
            
            getItineraryBtn.onclick = () => { // Use onclick to easily re-assign it
                const duration = document.getElementById('itinerary-duration').value || "3";
                const interests = document.getElementById('itinerary-interests').value || "genel turistik yerler ve yerel lezzetler";
                generateItinerary(countryName, duration, interests);
                itineraryModal.classList.remove('visible');
            };

            document.getElementById('get-cultural-tips-btn').addEventListener('click', () => {
                getCulturalTips(countryName);
            });

            document.getElementById('open-packing-list-btn').addEventListener('click', () => {
                const duration = document.getElementById('itinerary-duration').value || "7";
                generatePackingList(countryName, duration, 'mevsimine uygun');
            });
        };

        const callGeminiAPI = async (prompt, buttonElement, resultContainer) => {
            const originalButtonText = buttonElement.innerHTML;
            buttonElement.disabled = true;
            const spinnerIcon = `<svg class="animate-spin -ml-1 mr-3 h-5 w-5" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg>`;
            buttonElement.innerHTML = `<span class="inline-flex items-center">${spinnerIcon} Olu≈üturuluyor...</span>`;
            resultContainer.innerHTML = `<div class="content-card p-6 rounded-2xl text-center text-secondary">Akƒ±llƒ± asistanƒ±mƒ±z senin i√ßin hazƒ±rlƒ±yor...</div>`;

            try {
                const apiKey = ""; 
                const model = "gemini-2.5-flash-preview-09-2025";
                const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/${model}:generateContent?key=${apiKey}`;
                const payload = { contents: [{ parts: [{ text: prompt }] }] };

                const response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });

                if (!response.ok) {
                    const errorData = await response.json();
                    console.error("API Error Response:", errorData);
                    throw new Error(`API Hatasƒ±: ${response.status}. ${errorData.error?.message || 'Bilinmeyen bir hata olu≈ütu.'}`);
                }
                const result = await response.json();
                if (result.candidates && result.candidates.length > 0 && result.candidates[0].content?.parts?.[0]?.text) {
                     return result.candidates[0].content.parts[0].text;
                } else {
                    console.error("Beklenmedik API yanƒ±tƒ±:", result);
                    if(result.candidates && result.candidates[0].finishReason === 'SAFETY') {
                        throw new Error("ƒ∞√ßerik g√ºvenlik politikalarƒ± nedeniyle engellendi.");
                    }
                    throw new Error("API'den bo≈ü veya hatalƒ± formatta yanƒ±t alƒ±ndƒ±.");
                }
            } catch (error) {
                console.error('Gemini API Hatasƒ±:', error);
                resultContainer.innerHTML = `<div class="bg-red-500/10 text-red-500 p-4 rounded-lg text-center"><strong>Hata!</strong> ƒ∞stek i≈ülenemedi. Detay: ${error.message}</div>`;
                return null;
            } finally {
                buttonElement.disabled = false;
                buttonElement.innerHTML = originalButtonText;
            }
        };

        const generateItinerary = async (countryName, duration, interests) => {
            const resultDiv = document.getElementById('ai-results-container');
            const triggerBtn = document.getElementById('open-itinerary-modal-btn');
            const prompt = `L√ºtfen "${countryName}" i√ßin ${duration} g√ºnl√ºk, heyecan verici ve detaylƒ± bir seyahat planƒ± olu≈ütur. ƒ∞lgi alanlarƒ±: ${interests}. Plan, her g√ºn i√ßin Sabah, √ñƒüle, Ak≈üam aktiviteleri i√ßermeli. Her aktivite i√ßin kƒ±sa ve ilgi √ßekici bir a√ßƒ±klama ekle. Cevabƒ±nƒ± T√ºrk√ße ve Markdown formatƒ±nda, ba≈ülƒ±klar ve listeler kullanarak ver. Ana ba≈ülƒ±klar i√ßin '##', alt ba≈ülƒ±klar i√ßin '###' kullan.`;
            
            const text = await callGeminiAPI(prompt, triggerBtn, resultDiv);
            if(text) {
                resultDiv.innerHTML = `
                   <div class="content-card p-6 rounded-2xl">
                       <div class="flex justify-between items-center mb-4">
                           <h4 class="text-2xl font-bold">ƒ∞≈üte Macera Planƒ±n!</h4>
                           <button id="copy-itinerary-btn" class="btn btn-secondary px-3 py-1 rounded-md text-sm">Kopyala</button>
                       </div>
                       <div class="prose prose-sm sm:prose-base dark:prose-invert max-w-none">${formatGeminiResponse(text)}</div>
                   </div>`;
                document.getElementById('copy-itinerary-btn').addEventListener('click', () => copyToClipboard(text));
            }
        };

        const getCulturalTips = async (countryName) => {
            const resultDiv = document.getElementById('ai-results-container');
            const tipsBtn = document.getElementById('get-cultural-tips-btn');
            const prompt = `T√ºrkiye'den ${countryName}'e seyahat edecek bir turist i√ßin 5 √∂nemli k√ºlt√ºrel ipucu ve g√∂rg√º kuralƒ± listele. ƒ∞pu√ßlarƒ± pratik, anla≈üƒ±lƒ±r ve saygƒ±lƒ± bir tonda olmalƒ±. √ñrneƒüin, selamla≈üma, bah≈üi≈ü, giyim kurallarƒ±, hediyele≈üme ve ka√ßƒ±nƒ±lmasƒ± gereken hassas konular gibi ba≈ülƒ±klarƒ± ele al. Cevabƒ±nƒ± T√ºrk√ße ve Markdown formatƒ±nda ver.`;

            const text = await callGeminiAPI(prompt, tipsBtn, resultDiv);
            if(text) {
                 resultDiv.innerHTML = `
                   <div class="content-card p-6 rounded-2xl">
                       <h4 class="text-2xl font-bold mb-4">${countryName} ƒ∞√ßin K√ºlt√ºrel ƒ∞pu√ßlarƒ±</h4>
                       <div class="prose prose-sm sm:prose-base dark:prose-invert max-w-none">${formatGeminiResponse(text)}</div>
                   </div>`;
            }
        };

        const generatePackingList = async (countryName, duration, season) => {
            const resultDiv = document.getElementById('ai-results-container');
            const packingBtn = document.getElementById('open-packing-list-btn');
            const prompt = `L√ºtfen "${countryName}" i√ßin ${duration} g√ºnl√ºk, ${season} bir seyahate y√∂nelik detaylƒ± bir bavul hazƒ±rlama listesi olu≈ütur. Listeyi Giyim, Elektronik, Ki≈üisel Bakƒ±m ve Belgeler gibi pratik kategorilere ayƒ±r. Cevabƒ±nƒ± T√ºrk√ße ve Markdown formatƒ±nda ver.`;
            
            const text = await callGeminiAPI(prompt, packingBtn, resultDiv);
            if(text) {
                 resultDiv.innerHTML = `
                   <div class="content-card p-6 rounded-2xl">
                       <h4 class="text-2xl font-bold mb-4">Bavul Hazƒ±rlama Listen</h4>
                       <div class="prose prose-sm sm:prose-base dark:prose-invert max-w-none">${formatGeminiResponse(text)}</div>
                   </div>`;
            }
        };

        const getAiDestinationSuggestion = async () => {
            const userInput = aiPromptInput.value;
            if (!userInput.trim()) {
                showInfoModal("Eksik Bilgi", "L√ºtfen nasƒ±l bir tatil istediƒüinizi anlatan kƒ±sa bir metin girin.");
                return;
            }
            const prompt = `Ben bir seyahat planlama asistanƒ±yƒ±m. Kullanƒ±cƒ± ≈üu ≈üekilde bir seyahat istiyor: "${userInput}". Bu isteƒüe en uygun 3 farklƒ± √ºlkeyi √∂ner. Her √∂neri i√ßin √ºlke ismini kalƒ±n harflerle yaz, altƒ±na neden uygun olduƒüunu 2-3 c√ºmleyle a√ßƒ±kla. Cevabƒ±nƒ± sadece bu 3 √∂neriyi i√ßerecek ≈üekilde, ba≈üka bir giri≈ü veya sonu√ß c√ºmlesi olmadan, T√ºrk√ße ve Markdown formatƒ±nda ver.`;
            const text = await callGeminiAPI(prompt, getAiSuggestionBtn, aiSuggestionResult);
            if (text) {
                aiSuggestionResult.innerHTML = formatGeminiResponse(text);
            }
        };
        
        const fetchCurrencyRates = async () => {
            if (currencyRates) return;
            try {
                const response = await fetch('https://api.frankfurter.app/latest?from=TRY');
                const data = await response.json();
                currencyRates = data.rates;
                currencyRates['TRY'] = 1; // Base currency
            } catch (error) {
                console.error("D√∂viz kurlarƒ± alƒ±namadƒ±:", error);
                const converterContent = document.getElementById('currency-converter-content');
                if(converterContent) converterContent.innerHTML = `<p class="text-red-500">Kurlar y√ºklenemedi.</p>`;
            }
        };

        const initCurrencyConverter = (localCurrency) => {
            const container = document.getElementById('currency-converter-content');
            if (!currencyRates) {
                container.innerHTML = `<p class="text-red-500">Kurlar y√ºklenemedi.</p>`;
                return;
            }

            const currencies = Object.keys(currencyRates).sort();
            const optionsHtml = currencies.map(c => `<option value="${c}" ${c === 'TRY' ? 'selected' : ''}>${c}</option>`).join('');
            const localOptionsHtml = currencies.map(c => `<option value="${c}" ${c === localCurrency ? 'selected' : ''}>${c}</option>`).join('');

            container.innerHTML = `
                <div class="flex items-center gap-2">
                    <input type="number" id="from-amount" value="100" class="w-full p-2 rounded-lg bg-background border border-border-color">
                    <select id="from-currency" class="p-2 rounded-lg bg-background border border-border-color">${optionsHtml}</select>
                </div>
                <div class="text-center my-2 font-bold text-2xl text-accent">&darr; &uarr;</div>
                 <div class="flex items-center gap-2">
                    <input type="text" id="to-amount" readonly class="w-full p-2 rounded-lg bg-background border border-border-color">
                    <select id="to-currency" class="p-2 rounded-lg bg-background border border-border-color">${localOptionsHtml}</select>
                </div>`;
            
            const fromAmount = document.getElementById('from-amount');
            const fromCurrency = document.getElementById('from-currency');
            const toAmount = document.getElementById('to-amount');
            const toCurrency = document.getElementById('to-currency');
            
            const calculateCurrency = () => {
                const amount = parseFloat(fromAmount.value);
                const fromRate = currencyRates[fromCurrency.value];
                const toRate = currencyRates[toCurrency.value];
                if(isNaN(amount) || !fromRate || !toRate) {
                    toAmount.value = '';
                    return;
                }
                const result = (amount / fromRate) * toRate;
                toAmount.value = result.toFixed(2);
            };

            fromAmount.addEventListener('input', calculateCurrency);
            fromCurrency.addEventListener('change', calculateCurrency);
            toCurrency.addEventListener('change', calculateCurrency);
            
            calculateCurrency();
        };

        const renderChecklist = () => {
            const items = JSON.parse(localStorage.getItem('travelChecklist')) || [
                { text: "Pasaport ve Vize", completed: false, id: 1},
                { text: "U√ßak Biletleri ve Konfirmasyonlar", completed: false, id: 2},
                { text: "Nakit ve Kredi Kartlarƒ±", completed: false, id: 3},
                { text: "Priz D√∂n√º≈üt√ºr√ºc√º (Adapt√∂r)", completed: false, id: 4},
                { text: "Ki≈üisel ƒ∞la√ßlar ve ƒ∞lk Yardƒ±m Seti", completed: false, id: 5}
            ];
            
            checklistContainer.innerHTML = items.map(item => `
                <div class="checklist-item flex items-center justify-between p-3 rounded-lg bg-background ${item.completed ? 'completed' : ''}" data-id="${item.id}">
                    <div class="flex items-center">
                        <input type="checkbox" id="item-${item.id}" class="h-5 w-5 rounded border-gray-300 text-accent focus:ring-accent mr-3" ${item.completed ? 'checked' : ''}>
                        <label for="item-${item.id}" class="flex-grow">${item.text}</label>
                    </div>
                    <button class="delete-checklist-item text-gray-400 hover:text-red-500">&times;</button>
                </div>
            `).join('');

            saveChecklistState(items);
        };
        
        const saveChecklistState = (items) => {
            localStorage.setItem('travelChecklist', JSON.stringify(items));
        };
        
        const handleChecklistInteraction = (e) => {
            const items = JSON.parse(localStorage.getItem('travelChecklist'));
            const target = e.target;
            const itemDiv = target.closest('.checklist-item');
            if(!itemDiv) return;

            const itemId = parseInt(itemDiv.dataset.id, 10);

            if (target.type === 'checkbox') {
                const item = items.find(i => i.id === itemId);
                item.completed = target.checked;
            }
            if(target.classList.contains('delete-checklist-item')) {
                 const itemIndex = items.findIndex(i => i.id === itemId);
                 items.splice(itemIndex, 1);
            }
            saveChecklistState(items);
            renderChecklist();
        };

        checklistContainer.addEventListener('click', handleChecklistInteraction);
        
        addChecklistItemBtn.addEventListener('click', () => {
            const text = newChecklistItemInput.value.trim();
            if (text) {
                const items = JSON.parse(localStorage.getItem('travelChecklist'));
                items.push({ text: text, completed: false, id: Date.now() });
                saveChecklistState(items);
                renderChecklist();
                newChecklistItemInput.value = '';
            }
        });
        
        const applyTheme = (theme) => {
            document.documentElement.setAttribute('data-theme', theme);
            localStorage.setItem('theme', theme);
        };

        homeLink.addEventListener('click', (e) => {
            e.preventDefault();
            countryDetailView.classList.add('hidden');
            countryListView.classList.remove('hidden');
            searchInput.value = '';
            displayCountries();
        });
        
        suggestPlaceBtn.addEventListener('click', () => aiSuggestModal.classList.add('visible'));
        aiModalCloseBtn.addEventListener('click', () => aiSuggestModal.classList.remove('visible'));
        aiSuggestModal.addEventListener('click', (e) => {
            if (e.target === aiSuggestModal) aiSuggestModal.classList.remove('visible');
        });
        getAiSuggestionBtn.addEventListener('click', getAiDestinationSuggestion);

        checklistBtn.addEventListener('click', () => {
            renderChecklist();
            checklistModal.classList.add('visible');
        });
        checklistModalCloseBtn.addEventListener('click', () => checklistModal.classList.remove('visible'));
        checklistModal.addEventListener('click', (e) => {
            if (e.target === checklistModal) checklistModal.classList.remove('visible');
        });

        itineraryModalCloseBtn.addEventListener('click', () => itineraryModal.classList.remove('visible'));
        itineraryModal.addEventListener('click', (e) => {
            if (e.target === itineraryModal) itineraryModal.classList.remove('visible');
        });
        
        themeSwitcherBtn.addEventListener('click', () => {
            themeModal.classList.add('visible');
        });

        themeModalCloseBtn.addEventListener('click', () => {
            themeModal.classList.remove('visible');
        });

        themeModal.addEventListener('click', (e) => {
            if (e.target === themeModal) themeModal.classList.remove('visible');
        });
        
        document.querySelectorAll('.theme-option-btn').forEach(button => {
            button.addEventListener('click', () => {
                const theme = button.dataset.theme;
                applyTheme(theme);
                themeModal.classList.remove('visible');
            });
        });

        searchInput.addEventListener('input', (e) => displayCountries(e.target.value));
        
        modalCloseBtn.addEventListener('click', () => {
            infoModal.classList.remove('visible');
        });
        infoModal.addEventListener('click', (e) => {
            if (e.target === infoModal) infoModal.classList.remove('visible');
        });

        const initApp = async () => {
            const savedTheme = localStorage.getItem('theme') || 'light';
            applyTheme(savedTheme);
            await fetchCurrencyRates();
            displayCountries();

            try {
                (adsbygoogle = window.adsbygoogle || []).push({});
            } catch (e) {
                console.error("AdSense push error:", e);
            }
            
            setTimeout(() => {
                preloader.style.opacity = '0';
                preloader.addEventListener('transitionend', () => preloader.remove());
            }, 500);
        };
        
        initApp();

    });
    </script>
</body>
</html>

